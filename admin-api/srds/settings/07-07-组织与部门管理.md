# 系统设置 - 组织与部门管理

> 返回 [系统设置索引](../07-系统设置.md)

---

该模块用于支撑“薪资发放（payroll）”与“员工目录与映射”（见 `wallet_docs/admin-api/srds/18-员工目录与映射.md`）的组织主数据治理，避免长期仅依赖 Excel 文本字段导致部门漂移、重复发放与审计困难。

## 数据模型（建议）

```typescript
type DepartmentStatus = 'active' | 'archived';

interface Department {
  department_id: string;
  name: string;
  parent_department_id?: string | null;
  status: DepartmentStatus;
  created_at: string;
  created_by: string;
  updated_at: string;
  updated_by: string;
}
```

---

## F-ADMIN-123: 获取部门列表

**描述**: 获取组织部门列表，支持树形或平铺返回。

**HTTP 方法**: `GET /api/v1/admin/settings/org/departments`

**请求参数**:
```
?status=active               // active, archived
&mode=tree                   // tree, flat
&keyword=                     // 部门名称关键字
```

**响应 Schema**:
```json
{
  "success": true,
  "data": {
    "departments": [
      {
        "department_id": "dept-hr",
        "name": "人力资源部",
        "parent_department_id": null,
        "status": "active",
        "created_at": "2025-12-01T00:00:00Z",
        "created_by": "super_admin@company.com",
        "updated_at": "2025-12-10T10:00:00Z",
        "updated_by": "admin@company.com"
      }
    ]
  }
}
```

**权限要求**:
- 角色: SuperAdmin, Admin, HR, Finance (只读), Auditor (只读)

---

## F-ADMIN-124: 创建部门

**描述**: 创建部门节点。

**HTTP 方法**: `POST /api/v1/admin/settings/org/departments`

**请求 Schema**:
```json
{
  "name": "财务部",
  "parent_department_id": null,
  "reason": "新增组织架构"
}
```

**响应 Schema**:
```json
{
  "success": true,
  "message": "部门已创建",
  "data": {
    "department_id": "dept-finance",
    "name": "财务部",
    "parent_department_id": null,
    "status": "active",
    "created_at": "2025-12-10T10:00:00Z",
    "created_by": "super_admin@company.com"
  }
}
```

**业务规则**:
- 同级部门名称不可重复（可配置）
- 记录审计日志（含 reason）

**权限要求**:
- 角色: SuperAdmin

---

## F-ADMIN-125: 更新/归档部门

**描述**: 更新部门信息或归档部门（不建议物理删除）。

**HTTP 方法**: `PUT /api/v1/admin/settings/org/departments/{department_id}`

**路径参数**:
- `department_id`: 部门 ID

**请求 Schema**:
```json
{
  "name": "财务共享中心",
  "parent_department_id": null,
  "status": "active",
  "reason": "组织调整"
}
```

**响应 Schema**:
```json
{
  "success": true,
  "message": "部门已更新",
  "data": {
    "department_id": "dept-finance",
    "updated_at": "2025-12-10T10:30:00Z",
    "updated_by": "super_admin@company.com"
  }
}
```

**业务规则**:
- 归档前检查是否仍有关联员工（可配置：阻断或允许但提示）
- 记录审计日志（含 reason 与 diff）

**权限要求**:
- 角色: SuperAdmin

---

> 返回 [系统设置索引](../07-系统设置.md)

