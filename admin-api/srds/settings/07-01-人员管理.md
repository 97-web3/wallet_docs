# 系统设置 - 人员管理

> 返回 [系统设置索引](../07-系统设置.md)

---

## F-ADMIN-046: 获取管理员列表

**描述**: 获取系统管理员列表。

**HTTP 方法**: `GET /api/v1/admin/settings/admins`

**请求参数**:
```
?page=1
&page_size=20
&role=                       // 角色筛选（角色 code），例如: super_admin, admin, finance
&status=                     // 状态: active, disabled
&keyword=                    // 搜索 (用户名、邮箱)
```

**响应 Schema**:
```json
{
  "success": true,
  "data": {
    "admins": [
      {
        "admin_id": "admin-10001",
        "username": "admin@company.com",
        "name": "张三",
        "role": "admin",
        "status": "active",
        "two_factor_enabled": true,
        "last_login_at": "2025-12-10T08:30:00Z",
        "last_login_ip": "192.168.1.100",
        "created_at": "2025-01-01T00:00:00Z",
        "created_by": "super_admin@company.com"
      }
    ]
  },
  "pagination": {
    "page": 1,
    "page_size": 20,
    "total": 5,
    "total_pages": 1
  }
}
```

**权限要求**:
- 角色: SuperAdmin

---

## F-ADMIN-047: 创建管理员

**描述**: 创建新的管理员账户。

**HTTP 方法**: `POST /api/v1/admin/settings/admins`

**请求 Schema**:
```json
{
  "username": "newadmin@company.com",   // 邮箱作为用户名
  "name": "李四",
  "role": "finance",
  "password": "TempPass123!",           // 临时密码
  "require_password_change": true,      // 首次登录需修改密码
  "two_factor_required": true           // 强制启用 2FA
}
```

**响应 Schema**:
```json
{
  "success": true,
  "message": "管理员已创建",
  "data": {
    "admin_id": "admin-10006",
    "username": "newadmin@company.com",
    "name": "李四",
    "role": "finance",
    "status": "active",
    "created_at": "2025-12-10T10:00:00Z"
  }
}
```

**业务规则**:
- 用户名必须是有效邮箱
- 临时密码发送到邮箱
- 首次登录强制修改密码
- 记录创建日志

**权限要求**:
- 角色: SuperAdmin

**错误码**:
| 错误码 | HTTP 状态 | 描述 |
|--------|-----------|------|
| USERNAME_EXISTS | 409 | 用户名已存在 |
| INVALID_EMAIL | 400 | 邮箱格式无效 |
| INVALID_ROLE | 400 | 无效的角色 |

---

## F-ADMIN-048: 更新管理员

**描述**: 更新管理员信息。

**HTTP 方法**: `PUT /api/v1/admin/settings/admins/{admin_id}`

**路径参数**:
- `admin_id`: 管理员 ID

**请求 Schema**:
```json
{
  "name": "李四（更新）",
  "role": "admin",
  "status": "active"
}
```

**响应 Schema**:
```json
{
  "success": true,
  "message": "管理员已更新",
  "data": {
    "admin_id": "admin-10006",
    "name": "李四（更新）",
    "role": "admin",
    "updated_at": "2025-12-10T10:30:00Z",
    "updated_by": "super_admin@company.com"
  }
}
```

**权限要求**:
- 角色: SuperAdmin

---

## F-ADMIN-049: 禁用管理员

**描述**: 禁用管理员账户。

**HTTP 方法**: `POST /api/v1/admin/settings/admins/{admin_id}/disable`

**路径参数**:
- `admin_id`: 管理员 ID

**请求 Schema**:
```json
{
  "reason": "离职处理"
}
```

**响应 Schema**:
```json
{
  "success": true,
  "message": "管理员已禁用",
  "data": {
    "admin_id": "admin-10006",
    "status": "disabled",
    "disabled_at": "2025-12-10T10:00:00Z",
    "disabled_by": "super_admin@company.com"
  }
}
```

**业务规则**:
- 禁用后立即使所有会话失效
- 不能禁用自己
- 不能禁用最后一个 SuperAdmin

**权限要求**:
- 角色: SuperAdmin

**错误码**:
| 错误码 | HTTP 状态 | 描述 |
|--------|-----------|------|
| CANNOT_DISABLE_SELF | 400 | 不能禁用自己 |
| LAST_SUPER_ADMIN | 400 | 不能禁用最后一个超级管理员 |

---

## F-ADMIN-056: 重置管理员密码

**描述**: 重置管理员密码。

**HTTP 方法**: `POST /api/v1/admin/settings/admins/{admin_id}/reset-password`

**路径参数**:
- `admin_id`: 管理员 ID

**请求 Schema**:
```json
{
  "send_email": true,
  "require_change": true
}
```

**响应 Schema**:
```json
{
  "success": true,
  "message": "密码已重置，新密码已发送至邮箱",
  "data": {
    "admin_id": "admin-10006",
    "password_reset_at": "2025-12-10T10:00:00Z",
    "email_sent": true
  }
}
```

**权限要求**:
- 角色: SuperAdmin

---

## F-ADMIN-057: 修改自己的密码

**描述**: 管理员修改自己的登录密码。

**HTTP 方法**: `POST /api/v1/admin/settings/change-password`

**请求 Schema**:
```json
{
  "current_password": "OldPass123!",
  "new_password": "NewPass456!",
  "confirm_password": "NewPass456!"
}
```

**响应 Schema**:
```json
{
  "success": true,
  "message": "密码已修改",
  "data": {
    "password_changed_at": "2025-12-10T10:00:00Z",
    "next_expiry": "2026-03-10T10:00:00Z"
  }
}
```

**业务规则**:
- 新密码不能与最近 5 次相同
- 修改后当前会话保持，其他会话失效

**权限要求**:
- 角色: 已登录管理员

**错误码**:
| 错误码 | HTTP 状态 | 描述 |
|--------|-----------|------|
| WRONG_CURRENT_PASSWORD | 401 | 当前密码错误 |
| PASSWORD_TOO_WEAK | 400 | 新密码强度不足 |
| PASSWORD_RECENTLY_USED | 400 | 新密码与近期密码重复 |
| PASSWORD_MISMATCH | 400 | 两次输入密码不一致 |

---

> 返回 [系统设置索引](../07-系统设置.md)

