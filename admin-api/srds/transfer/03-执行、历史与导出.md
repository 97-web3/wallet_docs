# 转账管理 - 执行、历史与导出

> 返回 [转账管理索引](../11-转账管理.md)

---

## F-ADMIN-126: 执行批次

**描述**: 对已审批通过的批次发起执行（链上/系统内执行逻辑由后端决定）。

**HTTP 方法**: `POST /api/v1/admin/transfer/batches/{batch_id}/execute`

**请求头**:
```
Idempotency-Key: <UUID>      // 幂等键 (必填)
```

**路径参数**:
- `batch_id`: 批次 ID

**请求 Schema**:
```json
{
  "note": "开始执行批次",
  "2fa_code": "123456"
}
```

**响应 Schema**:
```json
{
  "success": true,
  "message": "批次已开始执行",
  "data": {
    "batch_id": "batch-20251210-001",
    "status": "processing",
    "started_at": "2025-12-10T09:00:00Z",
    "started_by": "system"
  }
}
```

**业务规则**:
- 执行前检查 Vault 余额（如适用）
- 支持幂等与断点续跑（建议）

**权限要求**:
- 角色: Admin, Finance

---

## F-ADMIN-093: 获取转账历史

**描述**: 获取所有转账的历史记录。

**HTTP 方法**: `GET /api/v1/admin/transfer/history`

**请求参数**:
```
?page=1
&page_size=50
&batch_id=                   // 批次 ID 筛选
&network=
&currency=
&address=                    // 收款地址搜索
&status=                     // pending, success, failed
&date_from=
&date_to=
```

**响应 Schema**:
```json
{
  "success": true,
  "data": {
    "transfers": [
      {
        "id": "transfer-001",
        "batch_id": "batch-20251210-001",
        "batch_name": "12月工资发放",
        "network": "Ethereum",
        "currency": "USDT",
        "to_address": "0x1234...5678",
        "amount": "5000.000000",
        "amount_usd": "5000.00",
        "fee": "0.125",
        "fee_usd": "0.31",
        "note": "张三工资",
        "status": "success",
        "tx_hash": "0xabc...123",
        "created_at": "2025-12-10T08:00:00Z",
        "processed_at": "2025-12-10T09:15:00Z"
      }
    ],
    "summary": {
      "total_transfers": 5680,
      "total_amount_usd": "8500000.00",
      "success_rate": "99.8%"
    }
  },
  "pagination": {
    "page": 1,
    "page_size": 50,
    "total": 5680,
    "total_pages": 114
  }
}
```

**权限要求**:
- 角色: Admin, Finance

---

## F-ADMIN-094: 导出批次报告

**描述**: 导出指定批次的转账报告。

**HTTP 方法**: `GET /api/v1/admin/transfer/batches/{batch_id}/export`

**路径参数**:
- `batch_id`: 批次 ID

**请求参数**:
```
?format=xlsx                 // xlsx, csv, pdf
```

**响应**: 文件流下载

**权限要求**:
- 角色: Admin, Finance

---

> 返回 [转账管理索引](../11-转账管理.md)

