# 内部转账记录

> 返回 [Admin 服务目录](./README.md)
>
> 关联模块：[05-账本与交易](./05-账本与交易.md)

---

## F-ADMIN-139: 获取内部转账记录列表

**描述**: 获取用户之间的内部转账记录（off-chain），支持筛选、分页与导出。

**HTTP 方法**: `GET /api/v1/admin/ledger/internal-transfers`

**请求参数**:
```
?page=1
&page_size=20
&status=                     // pending_pass, completed
&currency=
&sender_uid=
&receiver_uid=
&min_amount=
&max_amount=
&transfer_id=                // 转账ID（模糊/精确）
&created_from=
&created_to=
```

**响应 Schema**:
```json
{
  "success": true,
  "data": {
    "transfers": [
      {
        "transfer_id": "itx-20251214-001",
        "sender": {
          "uid": "10003",
          "username": "carol"
        },
        "receiver": {
          "uid": "10004",
          "username": "dave"
        },
        "currency": "USDT",
        "amount": "100.000000",
        "status": "completed",
        "need_pass": true,
        "hold_id": "hold_8f31c2...",
        "sender_transaction_id": "781230",
        "receiver_transaction_id": "781231",
        "notification_sent": true,
        "notification_sent_at": "2025-12-14T09:10:10Z",
        "created_at": "2025-12-14T09:10:00Z",
        "updated_at": "2025-12-14T09:10:05Z"
      }
    ]
  },
  "pagination": {
    "page": 1,
    "page_size": 20,
    "total": 128,
    "total_pages": 7
  }
}
```

**权限要求**:
- 角色: Admin, Finance

---

## F-ADMIN-140: 获取内部转账详情

**描述**: 获取内部转账记录的详细信息（含账本关联与通知追踪）。

**HTTP 方法**: `GET /api/v1/admin/ledger/internal-transfers/{transfer_id}`

**路径参数**:
- `transfer_id`: 内部转账记录 ID

**响应 Schema**:
```json
{
  "success": true,
  "data": {
    "transfer_id": "itx-20251214-001",
    "sender": {
      "uid": "10003",
      "username": "carol"
    },
    "receiver": {
      "uid": "10004",
      "username": "dave"
    },
    "currency": "USDT",
    "amount": "100.000000",
    "status": "completed",
    "note": "午餐AA",
    "need_pass": true,
    "hold_id": "hold_8f31c2...",
    "sender_transaction_id": "781230",
    "receiver_transaction_id": "781231",
    "notification_sent": true,
    "notification_sent_at": "2025-12-14T09:10:10Z",
    "created_at": "2025-12-14T09:10:00Z",
    "updated_at": "2025-12-14T09:10:05Z"
  }
}
```

**权限要求**:
- 角色: Admin, Finance

---

## 状态枚举

| 状态 | 代码 | 描述 |
|------|------|------|
| 待输入密码 | pending_pass | 等待发送方输入支付密码后继续 |
| 已完成 | completed | 转账完成（发送方扣款、接收方入账） |

---

> 返回 [Admin 服务目录](./README.md)

