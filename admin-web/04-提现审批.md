# 提现审批

> 返回 [后台管理前端目录](./README.md)

---

## 页面概述

- **页面路径**: `/admin/withdrawals`
- **权限要求**: Admin 或 Finance 角色
- **主要功能**: 提现/转账申请审批、风险评估查看、批量处理、驳回管理、审批配置

---

## 页面布局

### 审批列表页面结构

```
┌──────────────────────────────────────────────────────────────────────────┐
│  Header                                                                   │
├──────────┬───────────────────────────────────────────────────────────────┤
│          │  Breadcrumb: 首页 / 出金审批                                   │
│  Sidebar ├───────────────────────────────────────────────────────────────┤
│          │                                                                │
│          │  ┌──────────────────────────────────────────────────────────┐ │
│          │  │ Tab 切换                                    [审批配置]    │ │
│          │  │ [提现审批] [转账审批]                                      │ │
│          │  └──────────────────────────────────────────────────────────┘ │
│          │                                                                │
│          │  ┌──────────────────────────────────────────────────────────┐ │
│          │  │ 统计卡片                                                  │ │
│          │  │ [待审批: 15]  [今日通过: 32]  [今日驳回: 3]  [超时: 2]    │ │
│          │  └──────────────────────────────────────────────────────────┘ │
│          │                                                                │
│          │  ┌──────────────────────────────────────────────────────────┐ │
│          │  │ 筛选区域                                                  │ │
│          │  │ [状态▼] [链▼] [员工▼] [金额范围] [日期范围] [🔍] [重置]  │ │
│          │  └──────────────────────────────────────────────────────────┘ │
│          │                                                                │
│          │  ┌──────────────────────────────────────────────────────────┐ │
│          │  │ 操作栏                           [批量通过] [批量驳回]     │ │
│          │  ├──────────────────────────────────────────────────────────┤ │
│          │  │ □ │ID    │用户UID│身份│金额      │链 │状态  │风险│SLA│操作│ │
│          │  ├───┼──────┼───────┼────┼──────────┼───┼──────┼────┼───┼────┤ │
│          │  │ □ │W00123│10001  │员工│5,000 USDT│TRX│待审批│低  │2h │[审]│ │
│          │  │ □ │W00124│10002  │普通│50,000USDT│ETH│待审批│高  │12h│[审]│ │
│          │  │ □ │W00125│10003  │员工│1,000 USDT│BSC│已通过│-   │-  │[查]│ │
│          │  │ ...                                                       │ │
│          │  ├──────────────────────────────────────────────────────────┤ │
│          │  │                    < 1 2 3 4 5 ... 10 >                   │ │
│          │  └──────────────────────────────────────────────────────────┘ │
│          │                                                                │
└──────────┴───────────────────────────────────────────────────────────────┘
```

### 审批详情抽屉结构

```
┌────────────────────────────────────────┐
│  提现审批详情                     [×]  │
├────────────────────────────────────────┤
│                                        │
│  申请信息                              │
│  ┌──────────────────────────────────┐  │
│  │ 申请ID:     W00123               │  │
│  │ 申请时间:   2025-12-10 10:30:00  │  │
│  │ 提现金额:   5,000.00 USDT        │  │
│  │ 手续费:     2.00 USDT            │  │
│  │ 实际到账:   4,998.00 USDT        │  │
│  │ 链:         TRX                  │  │
│  │ 目标地址:   T9yD14N...Ww         │  │
│  │ SLA 状态:   正常 (剩余 22h)      │  │
│  └──────────────────────────────────┘  │
│                                        │
│  用户信息                              │
│  ┌──────────────────────────────────┐  │
│  │ UID:        10001                │  │
│  │ 手机号:     138****1234          │  │
│  │ 身份:       员工                  │  │
│  │ 账户状态:   正常                  │  │
│  │ Web2 余额:  10,000 USDT          │  │
│  │ 历史提现:   50 笔 / $200,000     │  │
│  └──────────────────────────────────┘  │
│                                        │
│  风险评估                              │
│  ┌──────────────────────────────────┐  │
│  │ 风险等级:   低风险 🟢            │  │
│  │                                  │  │
│  │ AML 检查:   通过 ✓               │  │
│  │ 地址检查:   非黑名单 ✓           │  │
│  │ 金额检查:   正常范围 ✓           │  │
│  │ 频率检查:   正常 ✓               │  │
│  │                                  │  │
│  │ 关联地址:   是 (免审批)          │  │
│  └──────────────────────────────────┘  │
│                                        │
│  审批操作                              │
│  ┌──────────────────────────────────┐  │
│  │ [驳 回]              [通 过]     │  │
│  └──────────────────────────────────┘  │
│                                        │
└────────────────────────────────────────┘
```

---

## 功能模块

### 1. 统计概览

**功能描述**: 显示提现审批相关的关键统计数据

**用户角色**: Admin / Finance

**UI 组件**:
- **StatisticCard**: 统计卡片组件

**统计项**:
| 统计项 | 说明 | 样式 |
|--------|------|------|
| 待审批 | 当前待处理的提现数量 | 蓝色 |
| 今日通过 | 今日已通过的提现数量 | 绿色 |
| 今日驳回 | 今日已驳回的提现数量 | 红色 |
| 超时未处理 | 超过 SLA 时间的待审批数量 | 橙色 |

**交互说明**:
- 点击统计卡片可快速筛选对应状态的列表

---

### 2. 提现列表筛选

**功能描述**: 多条件筛选提现申请

**用户角色**: Admin / Finance

**UI 组件**:
- **Select**: 状态、链筛选
- **RangePicker**: 金额范围、日期范围
- **Input**: 申请 ID / 用户 UID 搜索
- **Button**: 搜索、重置

**筛选条件**:
| 字段 | 组件类型 | 选项/说明 |
|------|----------|-----------|
| 状态 | Select | 全部、待审批、已通过、已驳回、处理中 |
| 链 | Select | 全部、TRX、ETH、BSC、Polygon |
| 用户身份 | Select | 全部、员工、非员工 |
| 金额范围 | InputNumber | 最小金额、最大金额 |
| 日期范围 | DatePicker.RangePicker | 申请时间范围 |
| 风险等级 | Select | 全部、低、中、高 |
| 关键词 | Input | 申请 ID 或用户 UID |

---

### 3. 提现列表展示

**功能描述**: 以表格形式展示提现申请列表

**用户角色**: Admin / Finance

**UI 组件**:
- **Table**: 数据表格
- **Tag**: 状态、风险标签
- **Progress**: SLA 进度条

**表格列定义**:
| 列名 | 字段 | 宽度 | 说明 |
|------|------|------|------|
| 选择 | - | 50px | 复选框（仅待审批状态可选） |
| 申请ID | request_id | 100px | 提现申请唯一标识 |
| 用户UID | user_id | 80px | 申请用户 |
| 身份 | identity | 60px | 员工/普通用户标签 |
| 金额 | amount | 120px | 提现金额和币种 |
| 链 | chain | 60px | 区块链网络 |
| 目标地址 | to_address | 150px | 脱敏显示 |
| 状态 | status | 80px | 状态标签 |
| 风险等级 | risk_level | 80px | 风险标签 |
| SLA | sla_remaining | 80px | 剩余处理时间 |
| 申请时间 | created_at | 160px | 申请提交时间 |
| 操作 | - | 100px | 操作按钮 |

**状态标签**:
| 状态 | 颜色 | 说明 |
|------|------|------|
| pending | 蓝色 | 待审批 |
| approved | 绿色 | 已通过 |
| rejected | 红色 | 已驳回 |
| processing | 黄色 | 处理中（链上确认中） |
| completed | 灰色 | 已完成 |
| failed | 红色 | 失败 |

**风险等级标签**:
| 等级 | 颜色 | 说明 |
|------|------|------|
| low | 绿色 | 低风险 |
| medium | 黄色 | 中风险 |
| high | 红色 | 高风险 |

**SLA 显示规则**:
| 状态 | 显示 |
|------|------|
| 剩余 > 12h | 绿色文字 |
| 剩余 4-12h | 黄色文字 |
| 剩余 < 4h | 红色文字 |
| 已超时 | 红色 "已超时" |

---

### 4. 提现审批详情

**功能描述**: 查看提现申请完整信息并进行审批操作

**用户角色**: Admin / Finance

**UI 组件**:
- **Drawer**: 抽屉容器
- **Descriptions**: 信息描述列表
- **Alert**: 风险提示
- **Button**: 审批操作按钮

#### 4.1 申请信息区

| 字段 | 说明 |
|------|------|
| 申请ID | 提现申请唯一标识 |
| 申请时间 | 用户提交申请的时间 |
| 提现金额 | 用户申请的提现金额 |
| 手续费 | 平台收取的手续费 |
| 实际到账 | 用户实际收到的金额 |
| 链 | 提现的区块链网络 |
| 目标地址 | 接收地址（可点击复制） |
| SLA 状态 | 处理时限状态 |

#### 4.2 用户信息区

| 字段 | 说明 |
|------|------|
| UID | 用户唯一标识 |
| 手机号 | 脱敏显示 |
| 身份 | 员工/非员工 |
| 账户状态 | 正常/冻结 |
| Web2 余额 | 当前 Web2 钱包余额 |
| 历史提现 | 历史提现统计 |

#### 4.3 风险评估区

**风险检查项**:
| 检查项 | 说明 | 结果显示 |
|--------|------|----------|
| AML 检查 | 反洗钱风险检查 | ✓ 通过 / ✗ 未通过 |
| 地址检查 | 目标地址黑名单检查 | ✓ 非黑名单 / ✗ 黑名单 |
| 金额检查 | 单笔金额限制检查 | ✓ 正常 / ⚠ 超限 |
| 频率检查 | 提现频率检查 | ✓ 正常 / ⚠ 频繁 |
| 关联地址 | 是否为用户关联的 Web3 地址 | 是（免审批）/ 否 |

**风险等级计算**:
- 低风险：所有检查通过
- 中风险：存在 1-2 项警告
- 高风险：存在未通过项或多项警告

---

### 5. 审批操作

**功能描述**: 对提现申请进行通过或驳回操作

**用户角色**: Admin / Finance

#### 5.1 通过审批

**触发方式**: 点击「通过」按钮

**确认对话框**:
```
┌────────────────────────────────────────┐
│  确认通过                         [×]  │
├────────────────────────────────────────┤
│                                        │
│  确定通过此提现申请吗？                │
│                                        │
│  申请ID:    W00123                     │
│  金额:      5,000.00 USDT              │
│  目标地址:  T9yD14N...Ww               │
│                                        │
│  通过后将立即执行链上转账操作          │
│                                        │
│         [取消]    [确认通过]           │
│                                        │
└────────────────────────────────────────┘
```

#### 5.2 驳回审批

**触发方式**: 点击「驳回」按钮

**驳回对话框**:
```
┌────────────────────────────────────────┐
│  驳回申请                         [×]  │
├────────────────────────────────────────┤
│                                        │
│  请选择驳回原因 *                      │
│                                        │
│  [○ 目标地址异常                      ]│
│  [○ AML 风险                          ]│
│  [○ 金额超出限制                      ]│
│  [○ 用户信息不符                      ]│
│  [○ 其他原因                          ]│
│                                        │
│  补充说明                              │
│  [________________________]            │
│  [________________________]            │
│                                        │
│  驳回后资金将退回用户 Web2 钱包        │
│                                        │
│         [取消]    [确认驳回]           │
│                                        │
└────────────────────────────────────────┘
```

**驳回原因码**:
| 原因码 | 说明 | 用户提示 |
|--------|------|----------|
| ADDRESS_RISK | 目标地址异常 | 提现地址存在风险，请更换地址后重试 |
| AML_RISK | AML 风险 | 该笔交易未通过合规审核 |
| AMOUNT_EXCEEDED | 金额超出限制 | 提现金额超出当前限额 |
| USER_INFO_MISMATCH | 用户信息不符 | 请联系客服核实身份信息 |
| OTHER | 其他原因 | 根据补充说明显示 |

---

### 6. 批量审批

**功能描述**: 对多笔提现申请进行批量操作

**用户角色**: Admin / Finance

**UI 组件**:
- **Checkbox**: 列表选择
- **Button**: 批量通过、批量驳回

**操作流程**:
1. 勾选待审批的申请（仅 pending 状态可选）
2. 点击「批量通过」或「批量驳回」
3. 弹出确认对话框
4. 确认后批量处理
5. 显示处理结果（成功 X 笔，失败 X 笔）

**批量通过确认**:
```
┌────────────────────────────────────────┐
│  批量通过                         [×]  │
├────────────────────────────────────────┤
│                                        │
│  确定批量通过以下 5 笔提现申请吗？     │
│                                        │
│  总金额: 25,000.00 USDT               │
│                                        │
│  ⚠️ 其中 1 笔为高风险交易              │
│                                        │
│         [取消]    [确认通过]           │
│                                        │
└────────────────────────────────────────┘
```

**批量驳回**:
- 需选择统一的驳回原因
- 可添加批量驳回说明

---

## UI 组件列表

| 组件名称 | 类型 | 功能说明 |
|----------|------|----------|
| WithdrawalStats | Card | 统计概览卡片 |
| WithdrawalFilter | Form | 筛选表单 |
| WithdrawalTable | Table | 提现列表表格 |
| WithdrawalDrawer | Drawer | 审批详情抽屉 |
| RiskAssessment | Card | 风险评估展示 |
| ApproveModal | Modal | 通过确认对话框 |
| RejectModal | Modal | 驳回对话框 |
| BatchApproveModal | Modal | 批量通过对话框 |
| BatchRejectModal | Modal | 批量驳回对话框 |
| SLAIndicator | Custom | SLA 状态指示器 |
| RiskTag | Tag | 风险等级标签 |

---

## 状态与交互

### 页面状态

| 状态 | 描述 | UI 表现 |
|------|------|---------|
| Loading | 列表加载中 | 显示表格骨架屏 |
| Empty | 无数据 | 显示空状态 |
| Selected | 已选择申请 | 显示选中数量，激活批量操作按钮 |
| Processing | 审批处理中 | 按钮显示 Loading |

### 实时更新

- 新提现申请实时推送到列表
- SLA 倒计时实时更新
- 审批状态变更实时同步

### 用户操作响应

| 操作 | 成功响应 | 失败响应 |
|------|----------|----------|
| 通过审批 | Toast "审批通过，正在执行转账"，刷新列表 | Alert 显示错误原因 |
| 驳回审批 | Toast "已驳回，资金已退回"，刷新列表 | Alert 显示错误原因 |
| 批量通过 | Toast "批量通过完成，成功 X 笔" | Alert 显示失败详情 |
| 批量驳回 | Toast "批量驳回完成" | Alert 显示失败详情 |

---

## 权限控制

| 功能 | Admin | Finance |
|------|-------|---------|
| 查看提现列表 | ✓ | ✓ |
| 查看审批详情 | ✓ | ✓ |
| 通过/驳回审批 | ✓ | ✓ |
| 批量审批 | ✓ | ✓ |
| 修改审批阈值 | ✓ | - |

---

## 审批规则提示

### 自动免审批条件

以下情况的提现申请自动通过，无需人工审批：
1. 目标地址为用户关联的 Web3 地址
2. 金额在自动审批阈值以下（可配置）
3. AML 检查通过

### 需人工审批条件

以下情况需要人工审批：
1. 高风险评级
2. 大额提现（超过自动审批阈值）
3. 目标地址首次使用
4. AML 检查异常

---

## 转账审批 Tab

**功能描述**: 审批用户间的内部转账申请

**触发方式**: 点击页面顶部的「转账审批」Tab

### 转账审批列表

与提现审批列表类似，但包含额外字段：

| 列名 | 字段 | 说明 |
|------|------|------|
| 转入用户UID | toUid | 接收转账的用户 |
| 转入用户 | toName | 接收用户名称 |

### 转账详情抽屉

**额外显示内容**:
```
┌──────────────────────────────────┐
│ 转入用户信息                     │
│ ┌──────────────────────────────┐ │
│ │ 用户UID:    10002            │ │
│ │ 用户名称:   张三              │ │
│ │ 手机号:     139****5678      │ │
│ │ 身份:       员工              │ │
│ └──────────────────────────────┘ │
└──────────────────────────────────┘
```

---

## 审批配置

**功能描述**: 配置提现和转账的审批规则

**触发方式**: 点击页面右上角的「审批配置」按钮

**权限要求**: 仅 Admin 角色可修改

### 审批配置对话框

```
┌────────────────────────────────────────────────────────────────┐
│  审批配置                                                  [×]  │
├────────────────────────────────────────────────────────────────┤
│                                                                │
│  提现审批设置                                                  │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │ 审批开关                                                 │  │
│  │ [  开启  ●━━━━━━━○  关闭  ]                             │  │
│  │                                                          │  │
│  │ 审批阈值 (关闭审批时生效)                                │  │
│  │ 单笔金额超过 [________] USDT 时需要审批                  │  │
│  │                                                          │  │
│  │ ⚠️ 关闭审批后，所有提现将自动通过（慎用）               │  │
│  └──────────────────────────────────────────────────────────┘  │
│                                                                │
│  转账审批设置                                                  │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │ 审批开关                                                 │  │
│  │ [  开启  ●━━━━━━━○  关闭  ]                             │  │
│  │                                                          │  │
│  │ 审批阈值 (关闭审批时生效)                                │  │
│  │ 单笔金额超过 [________] USDT 时需要审批                  │  │
│  │                                                          │  │
│  │ 员工免审批                                               │  │
│  │ [✓] 员工间转账免审批                                     │  │
│  └──────────────────────────────────────────────────────────┘  │
│                                                                │
│         [取消]    [保存配置]                                   │
│                                                                │
└────────────────────────────────────────────────────────────────┘
```

### 审批配置字段

| 字段 | 类型 | 说明 |
|------|------|------|
| withdrawalApprovalEnabled | boolean | 提现审批开关 |
| withdrawalThreshold | number | 提现审批阈值(USDT) |
| transferApprovalEnabled | boolean | 转账审批开关 |
| transferThreshold | number | 转账审批阈值(USDT) |
| employeeTransferExempt | boolean | 员工间转账免审批 |

---

> 返回 [后台管理前端目录](./README.md)
