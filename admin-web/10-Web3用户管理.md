# Web3 用户管理

> 返回 [后台管理前端目录](./README.md)

---

## 页面概述

- **页面路径**: `/admin/web3users`
- **权限要求**: Admin 角色
- **主要功能**: Web3 钱包用户管理、设备管理、多网络钱包地址管理、地址级黑名单管理

**说明**: Web3 用户与 Web2 用户分开管理。Web3 用户通过设备 ID (DeviceID) 标识，一个设备可绑定多个网络的钱包地址。

---

## 数据模型

### 钱包地址

```typescript
interface WalletAddress {
  network: string;           // 网络类型: Ethereum, BSC, Polygon, Tron
  address: string;           // 钱包地址
  enabled: boolean;          // 是否启用
  isBlacklisted: boolean;    // 是否在黑名单中
  blacklistReason?: string;  // 黑名单原因
}
```

### Web3 用户

```typescript
interface Web3User {
  id: string;                        // 用户ID
  deviceId: string;                  // 设备ID标识
  walletAddresses: WalletAddress[];  // 多钱包地址列表
  twoFactorEnabled: boolean;         // 2FA 认证状态
  biometricEnabled: boolean;         // 生物识别状态
  createdAt: string;                 // 创建时间
}
```

---

## 页面布局

### Web3 用户列表页面结构

```
┌──────────────────────────────────────────────────────────────────────────┐
│  Header                                                                   │
├──────────┬───────────────────────────────────────────────────────────────┤
│          │  Breadcrumb: 首页 / Web3 用户管理                              │
│  Sidebar ├───────────────────────────────────────────────────────────────┤
│          │                                                                │
│          │  ┌──────────────────────────────────────────────────────────┐ │
│          │  │ 统计卡片                                                  │ │
│          │  │ [设备总数: 156]  [钱包地址: 312]  [黑名单: 8 (2.5%)]     │ │
│          │  │ [支持网络: 4]                                            │ │
│          │  └──────────────────────────────────────────────────────────┘ │
│          │                                                                │
│          │  ┌──────────────────────────────────────────────────────────┐ │
│          │  │ 筛选区域                                                  │ │
│          │  │ [地址状态▼] [2FA▼] [生物识别▼] [搜索______] [🔍] [重置] │ │
│          │  │ [已选筛选标签...]                          [清空筛选]     │ │
│          │  └──────────────────────────────────────────────────────────┘ │
│          │                                                                │
│          │  ┌──────────────────────────────────────────────────────────┐ │
│          │  │ 设备卡片列表 (可展开/折叠)                                │ │
│          │  │ ┌────────────────────────────────────────────────────────┐│ │
│          │  │ │ 设备 Device-001               2FA: ✓  生物: ✓  [展开] ││ │
│          │  │ │ DeviceID: abc123...           钱包数: 4                ││ │
│          │  │ ├────────────────────────────────────────────────────────┤│ │
│          │  │ │ 展开后显示:                                            ││ │
│          │  │ │ │网络      │钱包地址           │状态    │操作         │││
│          │  │ │ │Ethereum  │0x1234...5678     │正常    │[黑名单][复制]│││
│          │  │ │ │BSC       │0xabcd...efgh     │黑名单  │[移除][复制]  │││
│          │  │ │ │Polygon   │0x9876...5432     │正常    │[黑名单][复制]│││
│          │  │ │ │Tron      │T9yD14...Ww       │正常    │[黑名单][复制]│││
│          │  │ └────────────────────────────────────────────────────────┘│ │
│          │  │ ┌────────────────────────────────────────────────────────┐│ │
│          │  │ │ 设备 Device-002               2FA: ✓  生物: ✗  [展开] ││ │
│          │  │ │ ...                                                    ││ │
│          │  │ └────────────────────────────────────────────────────────┘│ │
│          │  │                    < 1 2 3 4 5 ... 10 >                   │ │
│          │  └──────────────────────────────────────────────────────────┘ │
│          │                                                                │
└──────────┴───────────────────────────────────────────────────────────────┘
```

---

## 功能模块

### 1. 统计概览

**功能描述**: 显示 Web3 用户相关的关键统计数据

**用户角色**: Admin

**UI 组件**:
- **StatisticCard**: 统计卡片组件

**统计项**:

| 统计项 | 说明 | 样式 |
|--------|------|------|
| 设备总数 | 唯一 DeviceID 数量 | 蓝色 |
| 钱包地址总数 | 所有网络钱包地址数量 | 绿色 |
| 黑名单地址 | 黑名单地址数量及占比 | 红色 |
| 支持网络 | 支持的区块链网络数量 | 紫色 |

---

### 2. 用户筛选

**功能描述**: 多条件筛选 Web3 用户

**用户角色**: Admin

**UI 组件**:
- **Select**: 状态筛选下拉框
- **Input**: 搜索输入框
- **Tag**: 已选筛选标签
- **Button**: 搜索、重置、清空筛选

**筛选条件**:

| 字段 | 组件类型 | 选项 |
|------|----------|------|
| 地址状态 | Select | 全部、正常地址、黑名单地址 |
| 2FA 认证 | Select | 全部、已启用、未启用 |
| 生物识别 | Select | 全部、已启用、未启用 |
| 搜索关键词 | Input | DeviceID、钱包地址 |

**筛选标签功能**:
- 已选筛选条件以标签形式显示
- 点击标签上的 × 可移除单个筛选条件
- 点击「清空筛选」一键重置所有筛选

---

### 3. 设备卡片列表

**功能描述**: 以卡片形式展示设备及其关联的钱包地址

**用户角色**: Admin

**UI 组件**:
- **Card**: 设备卡片容器
- **Collapse**: 可折叠面板
- **Table**: 钱包地址表格
- **Badge**: 状态徽章
- **Pagination**: 分页组件

#### 3.1 设备卡片头部

| 显示内容 | 说明 |
|----------|------|
| 设备名称 | 设备标识名称 |
| DeviceID | 设备唯一标识（缩略显示） |
| 钱包数量 | 关联的钱包地址数量 |
| 2FA 状态 | ✓ 已启用 / ✗ 未启用 |
| 生物识别 | ✓ 已启用 / ✗ 未启用 |
| 展开/折叠 | 展开查看钱包详情 |

#### 3.2 钱包地址表格（展开后）

| 列名 | 字段 | 宽度 | 说明 |
|------|------|------|------|
| 网络 | network | 100px | Ethereum/BSC/Polygon/Tron |
| 钱包地址 | address | 200px | 缩略显示，可复制 |
| 状态 | status | 80px | 正常/黑名单 |
| 黑名单原因 | blacklistReason | 150px | 仅黑名单状态显示 |
| 操作 | - | 150px | 标记黑名单/移出黑名单/复制 |

**状态标签样式**:

| 状态 | 标签颜色 | 文字 |
|------|----------|------|
| normal | 绿色 | 正常 |
| blacklisted | 红色 | 黑名单 |

---

### 4. 地址黑名单管理

**功能描述**: 对单个钱包地址进行黑名单标记或移除

**用户角色**: Admin

#### 4.1 标记黑名单

**触发方式**: 点击钱包地址行的「标记黑名单」按钮

**确认对话框**:
```
┌────────────────────────────────────────┐
│  标记黑名单                        [×]  │
├────────────────────────────────────────┤
│                                        │
│  确定要将此地址标记为黑名单吗？        │
│                                        │
│  网络:     Ethereum                    │
│  地址:     0x1234...5678               │
│                                        │
│  标记后：                              │
│  • 该地址将被禁止进行任何交易          │
│  • 与该地址相关的转账将被拦截          │
│                                        │
│  黑名单原因 *                          │
│  [________________________]            │
│                                        │
│         [取消]    [确认标记]           │
│                                        │
└────────────────────────────────────────┘
```

#### 4.2 移出黑名单

**触发方式**: 点击黑名单地址行的「移出黑名单」按钮

**确认对话框**:
```
┌────────────────────────────────────────┐
│  移出黑名单                        [×]  │
├────────────────────────────────────────┤
│                                        │
│  确定要将此地址移出黑名单吗？          │
│                                        │
│  网络:     BSC                         │
│  地址:     0xabcd...efgh               │
│  原因:     可疑交易行为                │
│                                        │
│  移出后该地址可以正常进行交易          │
│                                        │
│         [取消]    [确认移出]           │
│                                        │
└────────────────────────────────────────┘
```

---

### 5. 密码管理

**功能描述**: 为 Web3 用户重置登录密码或交易密码

**用户角色**: Admin

**触发方式**: 点击设备卡片的「更多」→「重置密码」

**密码重置对话框**:
```
┌────────────────────────────────────────┐
│  重置密码                          [×]  │
├────────────────────────────────────────┤
│                                        │
│  设备: Device-001                      │
│  DeviceID: abc123...                   │
│                                        │
│  重置类型 *                            │
│  [○ 登录密码]  [○ 交易密码]           │
│                                        │
│  新密码 *                              │
│  [________________________]            │
│  至少8位，包含字母和数字               │
│                                        │
│  确认密码 *                            │
│  [________________________]            │
│                                        │
│  ⚠️ 密码重置后，将通过推送通知用户     │
│                                        │
│         [取消]    [确认重置]           │
│                                        │
└────────────────────────────────────────┘
```

---

### 6. 复制功能

**功能描述**: 快速复制设备ID或钱包地址

**用户角色**: Admin

**交互说明**:
- 点击「复制」按钮或地址旁的复制图标
- 复制成功后显示 Toast 提示：「已复制到剪贴板」

---

## UI 组件列表

| 组件名称 | 类型 | 功能说明 |
|----------|------|----------|
| Web3UserStats | Card | 统计概览卡片 |
| Web3UserFilter | Form | 筛选表单 |
| FilterTags | Tag | 筛选条件标签 |
| DeviceCard | Card | 设备卡片 |
| WalletTable | Table | 钱包地址表格 |
| BlacklistModal | Modal | 黑名单标记对话框 |
| RemoveBlacklistModal | Modal | 移出黑名单对话框 |
| PasswordResetModal | Modal | 密码重置对话框 |
| NetworkTag | Tag | 网络标签 |
| StatusBadge | Badge | 状态徽章 |
| CopyButton | Button | 复制按钮 |

---

## 状态与交互

### 页面状态

| 状态 | 描述 | UI 表现 |
|------|------|---------|
| Loading | 列表加载中 | 显示卡片骨架屏 |
| Empty | 无搜索结果 | 显示空状态图和提示 |
| Error | 加载失败 | 显示错误提示和重试按钮 |
| Expanded | 卡片已展开 | 显示钱包地址表格 |
| Collapsed | 卡片已折叠 | 仅显示设备概要信息 |

### 用户操作响应

| 操作 | 成功响应 | 失败响应 |
|------|----------|----------|
| 标记黑名单 | Toast "已标记为黑名单"，刷新列表 | Alert 显示错误原因 |
| 移出黑名单 | Toast "已移出黑名单"，刷新列表 | Alert 显示错误原因 |
| 重置密码 | Toast "密码重置成功"，关闭对话框 | Alert 显示错误原因 |
| 复制地址 | Toast "已复制到剪贴板" | Toast "复制失败" |

---

## 支持的网络

| 网络 | 标识 | 图标颜色 |
|------|------|----------|
| Ethereum | ETH | 蓝紫色 |
| BNB Smart Chain | BSC | 黄色 |
| Polygon | MATIC | 紫色 |
| Tron | TRX | 红色 |

---

## 权限控制

| 功能 | Admin | Finance |
|------|-------|---------|
| 查看 Web3 用户列表 | ✓ | - |
| 查看设备详情 | ✓ | - |
| 标记/移出黑名单 | ✓ | - |
| 重置密码 | ✓ | - |
| 导出数据 | ✓ | - |

---

## 安全设置说明

**重要提示**: Web3 用户的 2FA 认证和生物识别需要用户在 App 端自行设置，后台仅显示状态，不可修改。

| 设置 | 后台权限 |
|------|----------|
| 2FA 认证 | 只读显示 |
| 生物识别 | 只读显示 |

---

> 返回 [后台管理前端目录](./README.md)
