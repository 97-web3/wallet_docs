# Role & Permission Management (角色权限管理)

> Back to [Admin Web Docs](./README.md) · Up to [System Settings Index](./07-系统设置.md)

---

## Page Overview

- **Route (UI)**: `/admin/settings/roles`
- **Audience**: Security admins / tenant admins who manage authorization for Admin Web.
- **Primary Goal**: Provide a governable RBAC system for Admin Web modules, including auditability and least-privilege enforcement.

> Note: The legacy monolithic doc suggested “multiple roles per admin” in the UI, while the current Admin API SRD (`wallet_docs/admin-api/srds/07-系统设置.md`) models a single `role` per admin. Treat this as a documentation alignment item (see “Gaps” in `wallet_docs/admin-web/07-01-人员管理.md`).

---

## Concepts & Scope

### RBAC Layers

- **Role**: A named bundle of permissions (e.g., `finance`, `auditor`).
- **Permission**: Atomic capability expressed as `resource.action` (e.g., `withdraw.approve`, `ledger.export`).
- **Data Scope (recommended)**: Constraints on what data a permission applies to (e.g., only certain vaults or certain tenants).
- **SoD (Segregation of Duties) controls (recommended)**: Prevent conflicting role combinations (e.g., “create transfer batch” + “approve transfer execution”).

---

## UI / UX Specification

### Role List

**Table columns** (recommended minimum):

| Column | Field | Notes |
|---|---|---|
| Role Code | `code` | Unique, stable identifier; used in APIs |
| Display Name | `name` | Human-friendly label |
| Description | `description` | Business meaning |
| Type | `is_system` | System vs custom |
| Status | `status` | Active / Disabled |
| Assigned Admins | `admin_count` | Governance metric |
| Actions | - | View, Edit, Duplicate, Disable/Delete |

### Permission Matrix

Use a matrix to minimize role-misconfiguration. For scale, support:

- **Module grouping** and collapsible sections
- **Search within permissions**
- **Bulk select** (row, column, section)
- **Change summary** before saving (diff view)
- **Mandatory “reason” field** for changes (audit)

---

## Permission Catalog (Reference)

The legacy Admin Web doc listed 11 functional modules; use it as the UI grouping taxonomy, but keep the canonical permission names aligned to the Admin API SRD.

Example UI grouping:

| Module ID | Module Name | Example Permissions (illustrative) |
|---|---|---|
| `dashboard` | Dashboard | `dashboard.view`, `dashboard.export` |
| `vault` | Vault | `vault.read`, `vault.adjust` |
| `transfer` | Transfers | `transfer.read`, `transfer.execute` |
| `user` | Web2 Users | `user.read`, `user.write`, `user.freeze` |
| `web3users` | Web3 Users | `web3user.read`, `web3user.write` |
| `swap` | Swap Config | `swap.read`, `swap.config` |
| `withdraw` | Withdrawal Approval | `withdraw.read`, `withdraw.approve`, `withdraw.reject` |
| `settings` | System Settings | `settings.read`, `settings.write` |
| `report` | Reports | `report.read`, `report.export` |

---

## Business Rules (Enterprise Baseline)

- **Least privilege**: Roles should be designed around job functions; avoid “everything except X” patterns.
- **Role explosion prevention**:
  - Prefer **scopes** over creating per-team roles.
  - Provide **role templates** and **role mining** reports (recommended).
- **Change governance**:
  - Require **reason** for changes.
  - Support **dual control / approval** for sensitive role changes (recommended).
- **SoD enforcement** (recommended):
  - Define conflict matrix; prevent or require approvals when assigning conflicting roles.

---

## API Mapping (Current)

See `wallet_docs/admin-api/srds/07-系统设置.md`:

- `GET /api/v1/admin/roles` (role list with permissions)
- `POST /api/v1/admin/roles/assign` (assign role to admin)
- `GET /api/v1/admin/users/{uid}/permissions` (effective permissions)

---

> Back to [Admin Web Docs](./README.md)
