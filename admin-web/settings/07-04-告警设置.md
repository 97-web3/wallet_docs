# 告警设置

> 返回 [管理员网页文档](./README.md) · 上至 [系统设置索引](./07-系统设置.md)

---

## 页面概览

- **入口**: `/admin/settings` → 告警设置
- **目的**: 配置运营和风险事件（余额、交易所、系统健康）的检测规则和通知路由。
- **受众**: 管理员 / 运维（取决于组织结构）

> 告警事件的“认领(Ack)/指派/静默/恢复/复盘”闭环建议在独立的“告警中心”页面完成：`wallet_docs/admin-web/19-告警中心.md`。

---

## 告警规则模型（推荐基线）

| 字段 | 类型 | 备注 |
|---|---|---|
| `name` | string | 规则显示名称 |
| `type` | enum | `balance`（余额）, `transaction`（交易）, `system`（系统） |
| `condition` | object | 阈值、操作符、时间窗口 |
| `level` | enum | `WARNING`（警告）, `CRITICAL`（严重） |
| `channels[]` | array | `email`（邮件）, `in_app`（应用内）, `sms`（短信）, `webhook`（网络钩子） |
| `recipients` | object | 角色、用户、分发列表 |
| `mute_window` | time range | 可选（仅非严重事件） |
| `enabled` | boolean | 开关 |
| `created_at/by` | datetime/string | 审计信息 |

---

## UI / UX 规范（摘录自旧文档）

### 规则列表

**表格列**:

| 列名 | 字段 | 备注 |
|---|---|---|
| 规则名称 | `name` | - |
| 类型 | `type` | 余额 / 交易 / 系统 |
| 条件 | `condition` | 人类可读的表达式 |
| 等级 | `level` | 警告 / 严重 |
| 渠道 | `channels` | 邮件 / 应用内 / 短信 |
| 状态 | `enabled` | 开/关 |

### 创建规则（示例：余额告警）

```
┌────────────────────────────────────────┐
│  创建告警规则                   [×]  │
├────────────────────────────────────────┤
│                                        │
│  规则名称 *                            │
│  [________________________]            │
│                                        │
│  告警类型 *                            │
│  [○ 余额]  [○ 交易]  [○ 系统]      │
│                                        │
│  ── 余额规则 ──                        │
│                                        │
│  目标 *                                │
│  [金库        ▼] [TRX    ▼] [USDT▼]│
│                                        │
│  条件 *                                │
│  余额 [低于    ▼] [10000    ] USDT    │
│                                        │
│  等级 *                                │
│  [○ 警告]  [○ 严重]                  │
│                                        │
│  渠道 *                                │
│  [✓] 邮件  [✓] 应用内  [ ] 短信        │
│                                        │
│  通知角色 *                            │
│  [✓] admin  [✓] finance                │
│                                        │
│  静默窗口                              │
│  [02:00] - [06:00] (仅非严重事件)      │
│                                        │
│         [取消]    [保存]               │
│                                        │
└────────────────────────────────────────┘
```

---

## 安全与合规注意事项

- 通知目的地（邮件/网络钩子）是敏感配置；更改必须经过审计。
- 网络钩子 URL 应支持允许列表、签名和密钥轮换（推荐）。

---

> 返回 [管理员网页文档](./README.md)
