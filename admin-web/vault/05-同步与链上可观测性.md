# Vault / 同步与链上可观测性

> 返回 [Vault 资金管理索引](../10-Vault资金管理.md)

---

## 目标

- 清晰展示“余额数据从哪里来、是否可信、是否延迟”
- 支持手动同步与故障定位（节点/索引器/任务队列）
- 为资金运维提供链上执行可见性（pending 队列、nonce、Gas）

---

## 1. 同步状态（SRD 对齐）

### 1.1 概览卡片字段

- `last_sync_at`：最后同步时间
- `sync_status`：`synced | syncing | delayed | failed`
- （可选扩展）`alert.type/message`：同步延迟、失败原因摘要

### 1.2 详情页字段

- `sync_info.last_block_synced`
- `sync_info.current_block`
- `sync_info.blocks_behind`

---

## 2. 手动同步

> SRD 对齐：`POST /api/v1/admin/vault/{chain_id}/sync`

### 2.1 触发入口（建议）

- 网络卡片右上角「手动同步」
- 详情页顶部「重新同步」

### 2.2 UI 行为（建议）

- 点击后展示：
  - 同步任务已启动（返回 `sync_id`）
  - 卡片进入 `syncing` 状态
- 同步失败时：
  - 展示失败原因摘要（若后端返回）
  - 提供“重试/查看系统状态监控”的快捷入口（见 `wallet_docs/admin-web/14-系统状态监控.md`）

---

## 3. 链上可观测性与执行控制（建议）

### 3.1 可见性（建议字段）

- 活跃地址 `nonce`
- pending 交易数
- 最近 24h：失败/替换/加速记录
- Gas 信息：`gas_info.*`（手续费币余额、估算可执行笔数）

### 3.2 执行控制（高风险，建议权限受限）

- 对 pending 交易执行：
  - 加速（更高费率替换）
  - 取消（0 值自转替换）
- 约束：
  - Gas 策略上限来自系统设置
  - 所有操作必须写入审计日志（见 `vault/07-审计、权限与合规.md`）

