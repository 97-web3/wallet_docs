# 企业内部钱包 V1.0 产品需求文档

---

## 一、APP 架构

### 1. 钱包账户体系

| 体系 | 本质 | 控制权 | 使用场景 |
| --- | --- | --- | --- |
| **Web2 钱包（中心化账户，地址是公司总地址的派生子地址）** | 公司内部账本，公司的总钱包地址派生的子钱包地址给到用户 | 公司 | 薪资发放、内部划转、冻结异常账号 |
| **On-chain Web3 钱包（链上地址）** | 去中心化地址 | 员工个人 | 转账、提现、链上操作、外部自由使用 |

**支持的链：** TRX / BNB / ETH

**校验节点：**

| 业务节点 | 验证方式 |
| --- | --- |
| Web2：充值、提现、划转<br>Web3：发送、接收、闪兑 | 三选一认证：生物识别(Face ID)、2FA(Google Authenticator)、资金密码，按优先级顺序验证 |
| 手机号、邮箱修改绑定 | 2FA（GA + 验证码） |
| 修改资金密码 | 资金密码 + 2FA |
| 绑定平台账户 | 1. 调取设备生物识别(指纹、人脸) → Google Authenticator (TOTP)（App 调 GA 绑定接口 → 后台生成 TOTP Secret → 用户扫描二维码 → 输入 6 位 OTP 完成绑定）→ 资金密码<br>2. 验证码 |

### 2. APP 账户体系

- 进入 App 注册方式：手机号 / 邮箱 → 生成唯一 uid 作为数据库内的唯一识别
- 如果用户选择跳过，则可以没有手机号/邮箱生成的 uid 直接创建或导入钱包，只有 wallet address

### 3. 助记词及私钥的管理

- 生成 seed → 生成一套 12 位助记词（用户自行保存）→ 生成一套私钥（加密存储在用户本地设备上，加 iCloud 云备份钱包，支持通过 iCloud 恢复钱包）
- 助记词丢失则不可找回，永久丢失
- 私钥丢失 → 通过助记词导入钱包或 iCloud 备份恢复钱包，重新生成私钥及所有 wallet address

---

## 二、角色

| 角色 | APP 权限 | Web 管理后台权限 |
| --- | --- | --- |
| **C端使用者（主要群体是员工）** | 所有，注册账号就有 | 无 |
| **财务** | 所有，注册账号就有 | 发起批量发薪、审批提现、设置企业热钱包余额、查看企业热钱包余额、配置余额预警阈值、账本管理、Dashboard 查看 |
| **管理员** | 所有，注册账号就有 | 用户管理、权限管理、swap 配置、审批流配置 |

---

## 三、APP 端需求详情

### 功能模块总览

| 页面 | 功能 | 详细说明 | 补充说明 |
| --- | --- | --- | --- |
| **Landing page** | | ![][image1] | |
| | **创建钱包** | ![][image2] ![][image3] ![][image4] ![][image5] | 1. 资金密码（和平台账号的用户密码不是一个）：6位数字，必填<br>2. 助记词校验：抽查三个单词<br>3. 生物识别：打开调取手机的生物识别，可以选择跳过<br>4. 全部完成后在 feedback 页面展示注意事项，完成阅读后进入钱包 home 页<br>5. 创建时，默认派生三个链的地址（TRX / BNB / ETH） |
| | **导入钱包** | ![][image6] | 1. 通过私钥 + 助记词导入，助记词文案提示用户用空格隔开，支持粘贴 |
| **Home page** | **个人中心** | 点击首页 button 进入二级页面：<br>1. 钱包密码管理<br>2. 添加新钱包，需校验后添加，相当于添加全新的 seed，重走一遍创建流程<br>3. 地址簿管理：添加名称、地址<br>4. 语言切换：支持中英两种<br>5. 关联平台账户 | **关联平台账户：**<br>1. 如果目前 wallet 没有对应的平台账号，则提示用户去注册；如果有，则选择某一个钱包去绑定平台账户（验证码 + 生物识别）<br>2. 一个平台的 uid 只能绑定一个 address，双向 1:1 验证<br>3. 支持解绑后再绑定新的 wallet address |
| | **Wallet Account** | 1. 点击下拉按钮，展开二级页面：点击选择钱包账户、添加新的钱包账户（直接添加即可，使用同一套 seed）；添加新的钱包（走创建/导入的流程）![][image7]<br>2. 资金列表展示配置的三条网络上的资产及稳定币 USDT 金额，展示自己选择的币种价值来做展示，兑换率研发实时拉取 debank 内 token 的价格<br>3. 小眼睛点击可隐藏或展示金额<br>4. 需要有个 CTA 复制钱包地址，点击有个列表展示所有的 wallet address，选择某一个地址后点击可复制 | |
| | **发送** | 点击首页 button 进入二级页面，分为平台内部划转和链上转账两种 | **Offchain：**<br>1. 根据 uid 搜索到对应用户<br>2. 选择币种并输入要转账的金额，校验金额是否充足，充足进行下一步；不充足红色提示<br>3. 验证后完成转账<br>![][image8] ![][image9] ![][image10]<br><br>**Onchain：**<br>1. 路径：点击 home 页发送 → 选择币种 → 联动选择对应网络 → 输入金额 → 转账确认页<br>2. 在发生跨链转账时，如果当前账户内该链原生币不够支付 gas 需要提示用户，让用户自己充值<br>3. 需要对输入的 address 校验：是否和选择的链上的地址格式一致，避免输入了不属于该链的地址。本次仅支持：TRX / BNB / ETH<br>4. Address 校验：是否属于当前所选链（可能会有格式校验正确，但仍然不属于该链的情况，ETH 和 BNB 格式一致），拦截并提示"该地址不属于该链，请切换网络后重试"<br>5. Address 校验是否是内部地址，如果是则建议使用 offchain 转账功能<br>![][image11] ![][image12] ![][image13] ![][image14]<br>6. 交易状态：已发起 → 交易中 → 已完成 |
| | **接收** | 点击首页 button 进入二级页面：<br>1. 选择币种（admin 内配置 RPC, token 等）<br>2. 根据选择的币种，联动选择对应的网络<br>3. 展示收款二维码及地址<br>![][image15] ![][image16] | |
| | **闪兑** | 点击首页 button 进入二级页面<br>Admin 做配置功能，初步计划接 Uniswap：<br>1. 对接配置项：RPC, Router Contract Address<br>2. Swap 本身配置项：Additional Slippage，过期时间，是否启用<br><br>**后端API要求：**<br>- 提供获取默认滑点配置接口<br>- 接口返回：默认滑点值、滑点范围(0.1%~50%)、预设选项(0.5%/1%/3%) | |
| | **交易历史** | 点击首页 button 进入二级页面：<br>1. 交易类型分为三种：发送、接收、闪兑<br>2. 展示交易时间、交易金额、双方 address、gas 费用 | |
| | **资产详情** | 1. 展示字段：币种、金额、按兑换率等值的其他币种价值（跟着 wallet 选择的币种切换全局的等值币种展示）<br>2. 每种币在每条链上的金额做展示 | |
| | **平台账户 & Web3 钱包的切换按钮** | 1. 切换到平台账户无平台账号：点击切换至 email/tel 注册页<br>2. 切换到平台账户有平台账号：展示平台资金页面<br>3. 切换到 Web3 无钱包：钱包 landing page<br>4. 切换到 Web3 有钱包：展示 home 页，进入页面金额默认 `***` | |

### 特殊场景处理

1. uid 在黑名单内，强退
2. 如果是 uid 在黑名单内不允许绑定/解绑，提示用户；wallet address 在黑名单内，则直接强退

---

### 首页：Web2 钱包

- 账户余额（USDT/CNY——研发拉取实时兑换率）、交易记录
- **CTA：** 提现（支持提现到同账户 Web3 钱包下——不需要输入 address 直接提现，或者其他 wallet address 内）
- Web2 在转账给我们的关联 Web3 地址时，可以免审批
- 需要在 Web3 钱包内新增入口手动关联 Web2 钱包，关联钱包时安全验证
- 先校验关联钱包地址，再校验阈值（admin）

---

### 全局配置

#### 浮点数精确度

1. **代币数量：** 精确到小数点后七位，超过部分截取
2. **代币价值：** 精确到小数点后 2 位，超过部分截取

#### 验证码限制

1. **时间：** 允许 60s 发送一次验证码，验证码有效期为 5min
2. **次数：** 允许一小时发送 5 次验证码，首次记录时间为第一次发送验证码时间

#### 黑名单账户

1. **无法登录：** 若为黑名单账户无法登录
2. **强制退出：** 若为黑名单账户强制退出

---

### 登录/注册

#### 支持生物验证登录

**条件：**
1. 已开启生物验证（换设备或卸载后自动关闭）
2. 非首次登录
3. 判断是否是黑名单账号，是则登录失败，否则登录成功

#### 支持谷歌账号登录或注册

**查询系统用户账号内是否存在：**
1. **存在：** 判断该账号是否为后台黑名单账号，若是则登录失败，若不是则登录成功
2. **不存在：** 自动完成账号注册并登录成功

#### 支持手机/邮箱登录或注册

1. **格式验证（判断邮箱和手机号码格式）：**
   - 不正确：返回报错
   - 正确：点亮发送验证码 icon

2. **验证码验证：**
   - 不正确：返回报错
   - 正确：登录成功

3. **验证码校验：** 用户点击立即登录后进行验证码校验

4. **立即登录：** 用户输入邮箱或手机号码并输入验证码后点亮

---

### 资产页面

#### 金刚区

##### 1. 代币单位
- **支持单位：** 根据用户设置的计价单位展示
- **涉及范围：** Web2 钱包全局

##### 2. 交易记录
- **页面跳转：** 点击交易记录 icon 跳转至交易记录页面
- **交易记录功能：**
  1. **搜索：** 支持根据交易 ID 或币种进行筛选
  2. **分类：** 支持根据"全部"、"充值"、"提现"以及"划转"类型进行分类
  3. **订单列表：** 分类下展示对应的订单信息，点击对应的订单跳转至订单详情
  4. **订单状态：**
     - **处理中：** 充值扫描到区块交易时状态为处理中，提现初始状态，充值无该状态
     - **已完成：** 根据充值、提现、划转到账情况自动更新
     - **已驳回：** 若提现审核被驳回则状态更新为已驳回
  5. **订单详情：**
     - **交易 ID：** 唯一 ID，系统自动生成，由 12 位数字 + 英文组成
     - **交易时间：** 日期精确到时分秒，提现取发起提现时间，充值取到账时间
     - **交易类型：** 提现、充值、划转
     - **状态：** 参考订单状态
     - **充值信息：** 取交易发生时对应的信息
  6. **区块浏览器：** 点击后跳转至对应的区块链浏览器页面，并将交易哈希自动填充完成搜索
  7. **联系客服：** 点击后跳转至"联系支持"页面

##### 3. 总资产
- **功能：** 将账号内的代币价值相加并换算成对应的单位进行展示

##### 4. 隐私
- **功能：** 点击后账户内所有资产内容均按 `***` 展示
- **涉及范围：** Web2 钱包全局
- **默认状态：** 隐藏状态

##### 5. 充值（Web3 钱包或链上其它钱包充值）
1. **币种：** 展示后台配置中状态为"正常"的币种
2. **网络：** 展示对应币种后台配置中状态为"正常"的网络（用户要先选择币种）
3. **充值地址：** 用户选择币种和对应的网络后展示对应的地址和二维码，支持复制，充值地址为用户分配到的钱包子地址
4. **最小充值：** 最小支持充值 10 USDT（非 USDT 通过当前价格换算判断是否 > 10 USDT）
5. **状态：** 当扫到区块交易时状态为"处理中"，接收到充值后状态为"已完成"，无其它状态

##### 6. 提现（Web2 钱包提现至 Web3 钱包或链上其它钱包）
1. **提示：** 若用户未设置交易密码且未设置生物验证的时候提示用户设置交易密码
2. **币种：** 展示后台配置中状态为"正常"的币种
3. **网络：** 展示对应币种后台配置中状态为"正常"的网络（用户要先选择币种）
4. **提现地址：** 支持手动输入或长按粘贴，支持选择地址簿的地址
5. **提现金额：** 最小支持 10U（非 USDT 通过当前价格换算判断是否 > 10 USDT）
6. **可用金额：** 展示所有账户内该币种的数量
7. **手续费：** 根据后台配置手续费展示
8. **实际到账：** 提现金额 - 手续费金额 = 实际到账金额
9. **确认提现：** 需要将选择项和输入项全部选择或填写后，并且满足提现金额 > 10 USDT，提现金额 > 可用余额时才可点击（非 USDT 通过当前价格换算判断是否 > 10 USDT）
10. **提现验证：**
    - 已设置生物验证：验证生物信息，成功则开启提现、失败则拒绝提现
    - 未设置生物验证：交易密码验证，成功则开启提现、失败则拒绝提现
11. **提现审核：** 非绑定的钱包需要进行审核
12. **状态：** 默认为"处理中"，当审核未通过时状态为"已驳回"，当链上交易完成后状态为"已完成"

##### 7. 划转（Web2 钱包内部划转）
1. **提示：** 若用户未设置交易密码且未设置生物验证的时候提示用户设置交易密码
2. **接收方：** 支持根据"用户 ID"、"邮箱"、"手机号"划转，支持手动输入或长按粘贴
3. **币种：** 展示后台配置中状态为"正常"的币种
4. **网络：** 展示对应币种后台配置中状态为"正常"的网络（用户要先选择币种）
5. **提现地址：** 支持手动输入或长按粘贴，支持选择地址簿的地址
6. **划转金额：** 用户手动输入，需要大于 0
7. **可用金额：** 展示所有账户内该币种的数量
8. **备注：** 支持用户手动输入，限制最高支持 1000 个字符
9. **手续费：** 内部划转无手续费
10. **确认划转：** 需要将选择项和输入项全部选择或填写后，并且满足划转数量 > 0，确认划转按钮才可以点击
11. **划转验证：**
    - 已设置生物验证：验证生物信息，成功则开启划转、失败则拒绝划转
    - 未设置生物验证：交易密码验证，成功则开启划转、失败则拒绝划转
12. **状态：** 划转验证通过后则为"已完成"状态，无其它状态

#### 资产

1. **代币种类：** 展示后台配置中状态为"正常"的币种
2. **代币数量：** 展示账户内所有该币种的数量
3. **代币价值：** 根据数量以及当前展示的货币单位进行换算

#### 近期交易

参考"金刚区 - 交易记录 - 交易记录"

---

### 钱包切换

1. **场景限制：** 非登录 Web2 钱包状态也可切换 Web3 钱包
2. **切换：** 点击后跳转至 Web3 钱包

---

### 我的

#### 1. 用户信息

#### 2. 账户信息

##### 邮箱（用于邮箱登录）
- **记录：** 若用户通过邮箱注册则为注册过的邮箱，若非邮箱注册则允许用户绑定邮箱
- **绑定、更换邮箱：** 需要输入邮箱并通过验证码发送验证邮箱真实性，验证码正确则绑定成功（若开启了双重验证则需要额外进行交易密码或生物认证验证）

##### 手机号（用于手机号码登录）

##### 个人信息

#### 3. 安全设置

---

## 四、Admin 需求详情

### 1. Dashboard

- 总充值、总提现统计
- Web2 钱包总托管余额
- 企业 vault 余额（TRX / BNB / ETH / USDT）
- 余额低于阈值发预警（角色及阈值可配置）

### 2. 财务薪资发放

- 批量导入 Excel（字段：uid、币种、金额）
- 自动创建 Web2 钱包余额
- 支持批量审批及发放
- 发放日志记录与可导出报表

### 3. 用户管理

- 用户列表：uid、手机号、邮箱、身份（员工/非员工）
- 冻结、解冻、离职处理
- 角色标签管理，确保员工账户独立管理

### 4. Swap 配置

- 接入 DEX 清单管理
- 配置汇率接口和滑点规则
- 查看历史闪兑交易记录

### 5. 提现审批流

- 员工申请 Web2 → Onchain 提现
- **审批节点：**
  - AML 验证
  - 审批人员审核
  - 审核结果反馈 APP
- 系统记录链下账本

### 6. 角色与权限

- **角色类型：** 管理员、财务 ~~、审批员、普通员工~~
- **权限细化：**
  - 管理钱包配置
  - 审批提现
  - 查看/导出账本
  - 发放薪资

### 7. 账本管理

- Web2 内部划转记录
- Web2 → Onchain 出金记录
- Vault 资金操作记录
- **CTA：** 财务在 admin 调整 vault 金额

---

## 五、文案

### Web3 钱包页面

| 中文 | 英文 | 界面参考 |
| --- | --- | --- |
| **钱包的切换：** 平台账户、Web3 钱包<br>**按钮：** 创建新钱包、导入已有钱包 | Platform Account<br>Web3 Wallet<br>Create New Wallet<br>Import Wallet | ![][image17] |
| **助记词提示：**<br>重要：不要冒丢失钱包的风险，在信任的地点保存您的私钥助记词，以此保护您的钱包。如果您被应用锁定或更换新设备，这是找回钱包的唯一途径<br><br>**助记词蒙层：**<br>点击即可显示，请确保没有人在看您的屏幕<br><br>**助记词文案提示：**<br>这是您的私钥助记词，请按正确顺序写下它并妥善保管。如果任何人拥有您的私钥助记词，就能访问您的钱包。切勿与任何人共享该助记词<br><br>**按钮：** 验证 | **Important:**<br>Do not risk losing your wallet. Store your mnemonic phrase in a trusted and secure location to protect your wallet.<br>If you are locked out of the app or switch to a new device, this is the only way to recover your wallet.<br><br>Tap to reveal. Please ensure no one is viewing your screen.<br><br>This is your mnemonic phrase. Write it down in the correct order and keep it securely.<br>Anyone with access to this phrase can access your wallet. Never share it with anyone.<br><br>Verify | ![][image18] |
| 总资产<br>发送<br>接收<br>闪兑<br>交易记录<br>全部 | Total Asset<br>Send<br>Receive<br>Swap<br>Transaction Record<br>All | ![][image19] |
| 交易记录<br>接收 xxx<br>发送 xxx<br>闪兑 xxx | Transaction History<br>Receive xxx<br>Send xxx<br>Swap xxx | ![][image20] |
| **生物识别**（支持指纹和人脸）<br>**地址簿**（保存的钱包地址）<br>**语言**（小字展示当前语言）<br>**关联平台账户**（小字提示：关联的钱包地址可以免审批提币） | **Biometric Authentication** *(Supports fingerprint and face recognition)*<br>**Address Book** *(Saved wallet addresses)*<br>**Language** *(Displays the current language)*<br>**Linked Platform Account** *(Linked wallet addresses can withdraw without approval)* | ![][image21] |

---

## 附录：图片引用

[image1]: ./images/image1.png
[image2]: ./images/image2.png
[image3]: ./images/image3.png
[image4]: ./images/image4.png
[image5]: ./images/image5.png
[image6]: ./images/image6.png
[image7]: ./images/image7.png
[image8]: ./images/image8.png
[image9]: ./images/image9.png
[image10]: ./images/image10.png
[image11]: ./images/image11.png
[image12]: ./images/image12.png
[image13]: ./images/image13.png
[image14]: ./images/image14.png
[image15]: ./images/image15.png
[image16]: ./images/image16.png
[image17]: ./images/image17.png
[image18]: ./images/image18.png
[image19]: ./images/image19.png
[image20]: ./images/image20.png
[image21]: ./images/image21.png
