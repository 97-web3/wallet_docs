# 缓存封装 (cache/)

## F-CACHE-001: Redis 缓存封装

- **描述**: 基于 go-redis/v9 的全功能缓存封装
- **文件**: `common/cache/redis_cache.go`
- **功能**:
  - 键前缀管理
  - 字符串操作 (Set/Get/Delete/Exists)
  - JSON 序列化存储
  - 原子计数 (Incr/Decr)
  - Hash 操作
  - List 操作
  - Set 操作
  - Sorted Set 操作
  - 分布式锁

---

## 分布式锁

```go
// 获取锁
unlock, err := cache.Lock(ctx, "resource_key", time.Second*30)
if err != nil {
    // 获取锁失败
}
defer unlock()  // 释放锁

// 带重试的锁
unlock, err := cache.LockWithRetry(ctx, "resource_key", time.Second*30, 3, time.Millisecond*100)
```

---

## 支持的操作

| 类别 | 方法 |
|------|------|
| 字符串 | Set, Get, SetJSON, GetJSON, Delete, Exists, Expire, TTL |
| 计数 | Incr, IncrBy, Decr, DecrBy |
| Hash | HSet, HGet, HGetAll, HDel, HExists |
| List | LPush, RPush, LPop, RPop, LRange, LLen |
| Set | SAdd, SRem, SMembers, SIsMember, SCard |
| Sorted Set | ZAdd, ZRem, ZRange, ZRevRange, ZRangeByScore, ZCard, ZScore |
| 分布式锁 | Lock, LockWithRetry, SetNX |
