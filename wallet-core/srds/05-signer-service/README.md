# 签名服务 (Signer Service) - 软件需求文档

## 模块概述

### 用途

Signer 服务是 Internal-Wallet 系统的核心安全模块，负责 HD 钱包的密钥管理、交易签名、地址派生等密码学操作。该服务实现了热/冷钱包分离架构，确保私钥安全存储和签名操作的完整审计。

### 系统架构中的角色

```
Business Service / ChainRPC Service
                │
                ▼ gRPC (内部网络)
┌─────────────────────────────────────────────────────────────────┐
│                      Signer Service                              │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │                    安全边界                                │  │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │  │
│  │  │  Seed 管理  │  │  地址派生   │  │  交易签名   │        │  │
│  │  │             │  │             │  │             │        │  │
│  │  │ - 种子加密  │  │ - HD 派生   │  │ - ECDSA    │        │  │
│  │  │ - 状态管理  │  │ - 多链支持  │  │ - 批量签名  │        │  │
│  │  └─────────────┘  └─────────────┘  └─────────────┘        │  │
│  │                         │                                  │  │
│  │                         ▼                                  │  │
│  │  ┌───────────────────────────────────────────────────────┐│  │
│  │  │                  审计日志层                            ││  │
│  │  │   所有签名操作记录 → signature_logs 表                 ││  │
│  │  └───────────────────────────────────────────────────────┘│  │
│  └───────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────┘
                │
                ▼
         加密存储 (MariaDB)
     master_seeds / deposit_addresses
```

### 服务依赖

| 依赖 | 类型 | 用途 |
|------|------|------|
| MariaDB | 数据库 | 加密种子、地址、日志存储 |
| Redis | 缓存 | 会话和临时数据 |
| ETCD | 服务发现 | 服务注册 |

### 安全特性

| 特性 | 实现 |
|------|------|
| 种子加密 | AES-256-GCM |
| 密钥派生 | PBKDF2 (100,000 迭代) |
| HD 钱包 | BIP39 助记词 + BIP44 派生 |
| 热/冷分离 | 基于 Temperature 字段 |
| 审计日志 | 所有签名操作记录 |

---

## 文档目录

| 文档 | 描述 | 功能数量 |
|------|------|----------|
| [01-种子管理.md](./01-种子管理.md) | 初始化、导入、列表、状态更新 | 4 |
| [02-地址生成.md](./02-地址生成.md) | 用户充值地址、路径派生、批量生成 | 3 |
| [03-公钥导出.md](./03-公钥导出.md) | 单个、批量导出 | 2 |
| [04-交易签名.md](./04-交易签名.md) | 单笔签名、批量签名 | 2 |
| [05-消息签名.md](./05-消息签名.md) | 消息签名 | 1 |
| [06-日志与健康.md](./06-日志与健康.md) | 签名日志查询、健康检查 | 2 |
| [99-数据模型与配置.md](./99-数据模型与配置.md) | 数据库表、加密实现、配置、安全 | - |

**总功能数**: 14 个 RPC 接口

---

## 快速导航

- 返回 [总目录](../00-目录.md)
- 上一模块: [ChainSync 服务](../04-chainsync-service/)
- 下一模块: [通用基础设施](../06-common-infrastructure.md)
