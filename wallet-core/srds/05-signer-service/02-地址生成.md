# 地址生成

> 返回 [Signer 服务目录](./README.md)

---

## F-SIGN-005: 生成用户充值地址

**描述**: 为用户生成多条链的充值地址。

**gRPC 方法**: `GenerateUserDepositAddresses`

**请求 Schema**:
```json
{
  "seed_id": "seed_hot_001",
  "user_id": 10001,                      // 用户 ID (作为派生索引)
  "chains": ["TRN", "BSC", "ETH"],       // 要生成的链
  "requester": "business_service"
}
```

**响应 Schema**:
```json
{
  "code": 0,
  "message": "地址生成成功",
  "user_id": 10001,
  "addresses": [
    {
      "chain": "TRN",
      "address": "TKvjYxxxxxxxxxxx",
      "derivation_path": "m/44'/195'/0'/0/10001",
      "public_key": "04a1b2c3d4...",
      "compressed_pubkey": "02a1b2c3..."
    },
    {
      "chain": "BSC",
      "address": "0x1234567890abcdef...",
      "derivation_path": "m/44'/60'/0'/0/10001",
      "public_key": "04d5e6f7g8...",
      "compressed_pubkey": "03d5e6f7..."
    },
    {
      "chain": "ETH",
      "address": "0xabcdef1234567890...",
      "derivation_path": "m/44'/60'/1'/0/10001",
      "public_key": "04h9i0j1k2...",
      "compressed_pubkey": "02h9i0j1..."
    }
  ],
  "created_at": "2025-12-10T10:00:00Z"
}
```

**BIP44 派生路径规则**:

| 链 | Coin Type | Account | 派生路径模板 |
|----|-----------|---------|--------------|
| TRON | 195 | 0 | m/44'/195'/0'/0/{user_id} |
| BSC | 60 | 0 | m/44'/60'/0'/0/{user_id} |
| ETH | 60 | 1 | m/44'/60'/1'/0/{user_id} |

---

## F-SIGN-006: 根据路径获取地址

**描述**: 根据指定的派生路径获取地址。

**gRPC 方法**: `GetAddressFromPath`

**请求 Schema**:
```json
{
  "seed_id": "seed_hot_001",
  "chain": "TRN",
  "derivation_path": "m/44'/195'/0'/0/10001"
}
```

**响应 Schema**:
```json
{
  "code": 0,
  "message": "",
  "chain": "TRN",
  "address": "TKvjYxxxxxxxxxxx",
  "derivation_path": "m/44'/195'/0'/0/10001",
  "public_key": "04a1b2c3d4...",
  "compressed_pubkey": "02a1b2c3..."
}
```

---

## F-SIGN-007: 批量生成地址

**描述**: 批量生成连续索引的地址。

**gRPC 方法**: `GenerateAddressBatch`

**请求 Schema**:
```json
{
  "seed_id": "seed_hot_001",
  "chain": "TRN",
  "start_index": 0,
  "count": 100,
  "account": 0,                          // BIP44 account
  "change": 0                            // 0=external, 1=internal
}
```

**响应 Schema**:
```json
{
  "code": 0,
  "message": "",
  "seed_id": "seed_hot_001",
  "chain": "TRN",
  "start_index": 0,
  "count": 100,
  "addresses": [
    {
      "index": 0,
      "derivation_path": "m/44'/195'/0'/0/0",
      "address": "TKvjY...",
      "public_key": "04...",
      "compressed_pubkey": "02..."
    },
    // ... 更多地址
  ]
}
```
