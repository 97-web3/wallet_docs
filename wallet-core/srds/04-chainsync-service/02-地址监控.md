# 地址监控

> 返回 [ChainSync 服务目录](./README.md)

---

## F-SYNC-005: 添加地址监控

**描述**: 添加地址到监控列表，用于检测充值交易。

**gRPC 方法**: `AddAddressMonitor`

**请求 Schema**:
```json
{
  "chain": 1,
  "address": "TKvjYxxxxxxxxxxx",
  "monitor_type": 4,                    // MonitorType 枚举
  "priority": 3,                        // Priority 枚举
  "tag": "user_10001_deposit",          // 标签
  "webhook_url": "https://callback.example.com/notify",
  "metadata": {
    "user_id": "10001",
    "currency": "USDT"
  }
}
```

**响应 Schema**:
```json
{
  "success": true,
  "message": "地址监控已添加",
  "monitor_id": "mon_tron_123456"
}
```

**监控类型枚举 (MonitorType)**:

| 值 | 名称 | 描述 |
|----|------|------|
| 1 | MONITOR_TYPE_BALANCE | 余额变更监控 |
| 2 | MONITOR_TYPE_TRANSACTION | 交易监控 |
| 3 | MONITOR_TYPE_CONTRACT | 合约事件监控 |
| 4 | MONITOR_TYPE_ALL | 全部监控 |

**优先级枚举 (Priority)**:

| 值 | 名称 | 描述 |
|----|------|------|
| 1 | PRIORITY_LOW | 低 |
| 2 | PRIORITY_NORMAL | 普通 |
| 3 | PRIORITY_HIGH | 高 |
| 4 | PRIORITY_CRITICAL | 关键 |

---

## F-SYNC-006: 移除地址监控

**描述**: 从监控列表中移除地址。

**gRPC 方法**: `RemoveAddressMonitor`

**请求 Schema**:
```json
{
  "monitor_id": "mon_tron_123456",      // 监控 ID
  "chain": 1,                           // 可选
  "address": ""                         // 可选
}
```

**响应 Schema**:
```json
{
  "success": true,
  "message": "地址监控已移除",
  "removed_count": 1
}
```

---

## F-SYNC-007: 获取监控地址列表

**描述**: 获取当前监控的地址列表。

**gRPC 方法**: `GetMonitoredAddresses`

**请求 Schema**:
```json
{
  "chain": 1,                           // 可选
  "monitor_type": 0,                    // 可选
  "page": 1,
  "page_size": 20
}
```

**响应 Schema**:
```json
{
  "success": true,
  "monitors": [
    {
      "monitor_id": "mon_tron_123456",
      "chain": 1,
      "address": "TKvjYxxxxxxxxxxx",
      "monitor_type": 4,
      "priority": 3,
      "tag": "user_10001_deposit",
      "webhook_url": "https://...",
      "active": true,
      "created_at": 1702300000,
      "last_activity": 1702300800,
      "metadata": {
        "user_id": "10001"
      }
    }
  ],
  "total": 100,
  "active_count": 95
}
```
