# 服务商管理

> 返回 [ChainSync 服务目录](./README.md)

---

## F-SYNC-013: 获取服务商状态

**描述**: 获取 RPC 服务商的健康状态。

**gRPC 方法**: `GetProviderStatus`

**请求 Schema**:
```json
{
  "chain": 1,                           // 可选
  "provider_type": 0                    // 可选
}
```

**响应 Schema**:
```json
{
  "success": true,
  "providers": [
    {
      "provider_id": "quicknode_tron_1",
      "provider_type": 1,               // ProviderType 枚举
      "chain": 1,
      "name": "QuickNode TRON Mainnet",
      "endpoint": "https://tron.quicknode.pro/...",
      "healthy": true,
      "response_time_ms": 150,
      "success_rate": 99,
      "total_requests": 100000,
      "failed_requests": 100,
      "last_success_time": 1702300800,
      "last_error_time": 1702290000,
      "last_error": "",
      "is_primary": true,
      "weight": 1.0,
      "config": {}
    }
  ],
  "healthy_count": 3,
  "total_count": 4
}
```

**服务商类型枚举 (ProviderType)**:

| 值 | 名称 | 描述 |
|----|------|------|
| 1 | PROVIDER_TYPE_QUICKNODE | QuickNode |
| 2 | PROVIDER_TYPE_INFURA | Infura |
| 3 | PROVIDER_TYPE_ALCHEMY | Alchemy |
| 4 | PROVIDER_TYPE_MORALIS | Moralis |
| 5 | PROVIDER_TYPE_ANKR | Ankr |
| 6 | PROVIDER_TYPE_CUSTOM | 自定义 |

---

## F-SYNC-014: 切换服务商

**描述**: 手动切换到指定的 RPC 服务商。

**gRPC 方法**: `SwitchProvider`

**请求 Schema**:
```json
{
  "chain": 1,
  "provider_id": "infura_tron_1",
  "force_switch": false
}
```

**响应 Schema**:
```json
{
  "success": true,
  "message": "服务商已切换",
  "old_provider_id": "quicknode_tron_1",
  "new_provider_id": "infura_tron_1",
  "switch_reason": "manual"
}
```

---

## F-SYNC-015: 测试服务商连接

**描述**: 测试自定义服务商的连接状态。

**gRPC 方法**: `TestProvider`

**请求 Schema**:
```json
{
  "provider_id": "",                    // 可选：已有服务商
  "chain": 1,
  "endpoint": "https://custom-rpc.example.com",
  "credentials": {
    "api_key": "your-api-key"
  }
}
```

**响应 Schema**:
```json
{
  "success": true,
  "message": "连接测试成功",
  "response_time_ms": 200,
  "latest_block": "12345678",
  "provider_info": {
    "version": "v1.0.0",
    "network": "mainnet"
  }
}
```
