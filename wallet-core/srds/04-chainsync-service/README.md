# 链同步服务 (ChainSync Service) - 软件需求文档

## 模块概述

### 用途

ChainSync 服务是 Internal-Wallet 系统的区块链数据同步模块，负责实时监控区块链状态、同步区块数据、监控充值地址、追踪交易确认、管理 RPC 服务商等功能。是实现充值到账检测的核心组件。

### 系统架构中的角色

```
┌─────────────────────────────────────────────────────────────────┐
│                    ChainSync Service                             │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │                     同步引擎                               │  │
│  │  - 区块扫描    - 交易解析    - 事件监听                    │  │
│  └───────────────────────────────────────────────────────────┘  │
│                              │                                   │
│          ┌───────────────────┼───────────────────┐              │
│          ▼                   ▼                   ▼              │
│  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐       │
│  │  地址监控器   │  │  余额追踪器   │  │  通知推送器   │       │
│  └───────────────┘  └───────────────┘  └───────────────┘       │
│          │                   │                   │              │
│          └───────────────────┼───────────────────┘              │
│                              ▼                                   │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │               RPC Provider Pool                            │  │
│  │   QuickNode │ Infura │ Alchemy │ Moralis │ Ankr           │  │
│  │   (自动故障转移 / 负载均衡 / 健康检查)                      │  │
│  └───────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
                      区块链网络 (TRON/BSC/ETH)
```

### 服务依赖

| 依赖 | 类型 | 用途 |
|------|------|------|
| MariaDB | 数据库 | 区块、交易、监控数据存储 |
| Redis | 缓存 | 同步状态缓存 |
| ETCD | 服务发现 | 服务注册 |
| RPC 节点 | HTTP | 区块链数据获取 |
| Kafka | 消息队列 | 事件通知 (可选) |

---

## 文档目录

| 文档 | 描述 | 功能数量 |
|------|------|----------|
| [01-同步状态管理.md](./01-同步状态管理.md) | 启动、停止、状态查询、重置 | 4 |
| [02-地址监控.md](./02-地址监控.md) | 添加、移除、列表 | 3 |
| [03-交易监控.md](./03-交易监控.md) | 交易详情、地址历史、区块交易 | 3 |
| [04-余额监控.md](./04-余额监控.md) | 单地址、多地址余额 | 2 |
| [05-服务商管理.md](./05-服务商管理.md) | 状态、切换、测试 | 3 |
| [06-统计信息.md](./06-统计信息.md) | 同步统计、性能指标 | 2 |
| [99-数据模型与配置.md](./99-数据模型与配置.md) | 数据库表、配置、依赖、安全 | - |

**总功能数**: 17 个 RPC 接口

---

## 快速导航

- 返回 [总目录](../00-目录.md)
- 上一模块: [ChainRPC 服务](../03-chainrpc-service/)
- 下一模块: [签名服务](../05-signer-service/)
