# 偏好设置

> 返回 [业务服务目录](./README.md)

---

## F-BUS-032: 获取偏好设置

**描述**: 获取用户偏好设置。

**gRPC 方法**: `GetPreferences`

**请求 Schema**:
```json
{}
```

**响应 Schema**:
```json
{
  "success": true,
  "language": 1,           // 1=中文, 2=英文
  "theme_mode": "light",
  "price_unit": 2,         // 1=CNY, 2=USD
  "language_options": [1, 2],
  "price_unit_options": [1, 2]
}
```

---

## F-BUS-033: 设置偏好

**描述**: 更新用户偏好设置。

**gRPC 方法**: `SetPreferences`

**请求 Schema**:
```json
{
  "language": 1,
  "theme_mode": "dark",
  "price_unit": 1
}
```

**响应 Schema**:
```json
{
  "success": true,
  "message": "设置已保存"
}
```

---

## F-BUS-076: 获取语言资源

**描述**: 获取指定语言的翻译资源包，支持增量更新和按模块加载。

**gRPC 方法**: `GetLanguageResources`

**请求 Schema**:
```json
{
  "language": "zh-CN",                              // 语言代码: zh-CN/en-US
  "version": "1.0.0",                               // 可选：当前版本，用于增量更新
  "modules": ["common", "wallet", "settings"]       // 可选：指定模块，为空则返回全部
}
```

**响应 Schema**:
```json
{
  "success": true,
  "language": "zh-CN",
  "version": "1.0.1",
  "is_incremental": false,
  "resources": {
    "common": {
      "confirm": "确认",
      "cancel": "取消",
      "loading": "加载中...",
      "success": "成功",
      "failed": "失败",
      "retry": "重试",
      "copy": "复制",
      "copied": "已复制",
      "save": "保存",
      "delete": "删除",
      "edit": "编辑",
      "search": "搜索",
      "no_data": "暂无数据",
      "load_more": "加载更多",
      "pull_to_refresh": "下拉刷新"
    },
    "wallet": {
      "balance": "余额",
      "total_assets": "总资产",
      "deposit": "充值",
      "withdraw": "提现",
      "transfer": "转账",
      "swap": "闪兑",
      "transaction_history": "交易记录",
      "address": "地址",
      "copy_address": "复制地址",
      "scan_qr": "扫描二维码",
      "amount": "金额",
      "fee": "手续费",
      "network": "网络",
      "status_pending": "处理中",
      "status_completed": "已完成",
      "status_failed": "已失败",
      "status_rejected": "已驳回"
    },
    "settings": {
      "language": "语言",
      "theme": "主题",
      "theme_light": "浅色模式",
      "theme_dark": "深色模式",
      "security": "安全设置",
      "trade_password": "交易密码",
      "biometric": "生物识别",
      "google_auth": "谷歌验证器",
      "notification": "通知设置",
      "about": "关于我们",
      "logout": "退出登录"
    },
    "auth": {
      "login": "登录",
      "register": "注册",
      "phone": "手机号",
      "email": "邮箱",
      "verification_code": "验证码",
      "send_code": "发送验证码",
      "resend_in": "{seconds}秒后重发",
      "password": "密码",
      "forgot_password": "忘记密码"
    },
    "errors": {
      "network_error": "网络异常，请稍后重试",
      "server_error": "服务器错误",
      "invalid_params": "参数错误",
      "insufficient_balance": "余额不足",
      "amount_too_small": "金额低于最小限制",
      "address_invalid": "地址格式错误",
      "code_expired": "验证码已过期",
      "code_invalid": "验证码错误",
      "password_wrong": "密码错误",
      "account_locked": "账户已锁定"
    }
  },
  "updated_at": "2025-12-10T10:00:00Z"
}
```

**业务规则**:
- 支持语言: `zh-CN` (简体中文), `en-US` (英文)
- 支持增量更新: 传入 version 时对比版本号，若有更新则返回增量内容
- 资源按模块组织，支持按需加载，减少首次加载数据量
- 客户端应缓存语言资源，仅在版本变更时更新
- 模块包含: common (通用), wallet (钱包), settings (设置), auth (认证), errors (错误提示)

**语言代码对照**:
| 代码 | 语言 | 描述 |
|------|------|------|
| zh-CN | 简体中文 | 默认语言 |
| en-US | 英文 | English |

---

## F-BUS-077: 检查语言资源更新

**描述**: 检查语言资源是否有新版本可用。

**gRPC 方法**: `CheckLanguageUpdate`

**请求 Schema**:
```json
{
  "language": "zh-CN",
  "current_version": "1.0.0"
}
```

**响应 Schema**:
```json
{
  "success": true,
  "has_update": true,
  "latest_version": "1.0.1",
  "updated_modules": ["common", "errors"],
  "update_size": 2048,
  "release_notes": "修复部分翻译问题"
}
```

**业务规则**:
- 仅返回是否有更新，不返回完整资源
- 用于客户端后台静默检查更新
