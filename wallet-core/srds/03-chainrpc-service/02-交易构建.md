# 交易构建

> 返回 [ChainRPC 服务目录](./README.md)

---

## F-CRPC-005: 构建主币转账

**描述**: 构建原生币 (TRX/BNB/ETH/MATIC) 转账的未签名交易。

**gRPC 方法**: `BuildNativeTransfer`

**请求 Schema**:
```json
{
  "chain": 1,
  "from_address": "TKvjY...",
  "to_address": "TAbcD...",
  "amount": "1000000",                  // 最小单位 (wei/sun)
  "gas_price": "",                      // 可选，空则自动获取
  "gas_limit": 0,                       // 可选，空则自动估算
  "nonce": "",                          // 可选，空则自动获取
  "gas_speed": 2,                       // GasSpeed 枚举
  "memo": ""                            // TRON 支持备注
}
```

**响应 Schema**:
```json
{
  "success": true,
  "message": "",
  "raw_transaction": "0a02...",         // hex 编码未签名交易
  "tx_hash_preview": "abc123...",
  "gas_price": "1000000000",
  "gas_limit": 21000,
  "estimated_fee": "21000000000000",
  "nonce": "5",
  "extra_data": {}
}
```

---

## F-CRPC-006: 构建代币转账

**描述**: 构建 ERC20/BEP20/TRC20 代币转账的未签名交易。

**gRPC 方法**: `BuildTokenTransfer`

**请求 Schema**:
```json
{
  "chain": 1,
  "from_address": "TKvjY...",
  "to_address": "TAbcD...",
  "token_contract": "TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t",
  "amount": "1000000",                  // 代币最小单位
  "gas_price": "",
  "gas_limit": 0,
  "nonce": "",
  "gas_speed": 2
}
```

**响应 Schema**:
```json
{
  "success": true,
  "message": "",
  "raw_transaction": "0a02...",
  "tx_hash_preview": "def456...",
  "gas_price": "1000000000",
  "gas_limit": 60000,
  "estimated_fee": "60000000000000",
  "nonce": "6",
  "extra_data": {
    "token_contract": "TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t"
  }
}
```

---

## F-CRPC-007: 构建批量转账

**描述**: 构建多笔转账交易，用于归集场景。

**gRPC 方法**: `BuildBatchTransfer`

**请求 Schema**:
```json
{
  "chain": 1,
  "from_address": "TKvjY...",
  "transfers": [
    {
      "to_address": "TAbcD...",
      "amount": "1000000",
      "token_contract": ""              // 空表示主币
    },
    {
      "to_address": "TEfgH...",
      "amount": "2000000",
      "token_contract": "TR7N..."
    }
  ],
  "gas_price": "",
  "gas_speed": 2
}
```

**响应 Schema**:
```json
{
  "success": true,
  "message": "",
  "transactions": [
    {
      "raw_transaction": "...",
      "tx_hash_preview": "...",
      "gas_price": "...",
      "gas_limit": 21000,
      "estimated_fee": "...",
      "nonce": "5"
    }
  ],
  "total": 2,
  "total_estimated_fee": "..."
}
```
