# 交易查询

> 返回 [ChainRPC 服务目录](./README.md)

---

## F-CRPC-017: 查询交易详情

**描述**: 获取交易的完整详情。

**gRPC 方法**: `GetTransaction`

**请求 Schema**:
```json
{
  "chain": 1,
  "tx_hash": "abc123...",
  "include_logs": true
}
```

**响应 Schema**:
```json
{
  "success": true,
  "message": "",
  "transaction": {
    "tx_hash": "abc123...",
    "chain": 1,
    "block_number": "12345678",
    "block_hash": "def456...",
    "block_timestamp": 1702300800,
    "transaction_index": 5,
    "from_address": "TKvjY...",
    "to_address": "TAbcD...",
    "value": "1000000000",
    "gas_price": "1000000000",
    "gas_limit": 21000,
    "gas_used": 21000,
    "gas_fee": "21000000000000",
    "status": 2,
    "nonce": "5",
    "input_data": "",
    "confirmations": 100,
    "contract_address": "",
    "logs": [],
    "error_message": ""
  }
}
```

---

## F-CRPC-018: 查询交易状态

**描述**: 查询交易的确认状态。

**gRPC 方法**: `GetTransactionStatus`

**请求 Schema**:
```json
{
  "chain": 1,
  "tx_hash": "abc123..."
}
```

**响应 Schema**:
```json
{
  "success": true,
  "message": "",
  "status": 2,                          // TxStatus 枚举
  "confirmations": 100,
  "required_confirmations": 12,
  "is_confirmed": true,
  "block_number": "12345678"
}
```

**交易状态枚举**:

| 值 | 名称 | 描述 |
|----|------|------|
| 1 | TX_STATUS_PENDING | 待确认 |
| 2 | TX_STATUS_CONFIRMED | 已确认 |
| 3 | TX_STATUS_FAILED | 失败 |
| 4 | TX_STATUS_DROPPED | 被丢弃 |
| 5 | TX_STATUS_REPLACED | 被替换 |

---

## F-CRPC-019: 查询交易收据

**描述**: 获取交易执行收据。

**gRPC 方法**: `GetTransactionReceipt`

**请求 Schema**:
```json
{
  "chain": 1,
  "tx_hash": "abc123..."
}
```

**响应 Schema**:
```json
{
  "success": true,
  "message": "",
  "receipt": {
    "tx_hash": "abc123...",
    "block_number": "12345678",
    "block_hash": "def456...",
    "transaction_index": 5,
    "from_address": "TKvjY...",
    "to_address": "TAbcD...",
    "gas_used": 21000,
    "gas_fee": "21000000000000",
    "status": 2,
    "logs": [],
    "contract_address": ""
  }
}
```
