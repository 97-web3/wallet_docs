# 认证中间件

## F-GW-003: JWT Token 认证

**描述**: 基于 JWT 的无状态认证机制。

**认证流程**:
1. 从 `Authorization: Bearer <token>` 提取 Token
2. 验证 Token 签名和有效期
3. 解析用户信息注入请求上下文
4. 验证失败返回 401 Unauthorized

**请求头格式**:
```
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

**Token Payload 结构**:
```json
{
  "user_id": "10001",
  "exp": 1702300800,
  "iat": 1702214400
}
```

**配置项**:

| 配置 | 类型 | 默认值 | 描述 |
|------|------|--------|------|
| AccessSecret | string | - | JWT 签名密钥 |
| AccessExpire | int | 86400 | Access Token 有效期 (秒) |
| RefreshSecret | string | - | Refresh Token 签名密钥 |
| RefreshExpire | int | 604800 | Refresh Token 有效期 (秒) |
