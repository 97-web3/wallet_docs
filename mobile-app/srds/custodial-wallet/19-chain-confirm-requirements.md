# 确认提币页面 - 软件需求规格说明书

## 1. 页面标识

| 属性 | 值 |
|------|-----|
| 页面ID | CW-019 |
| 页面名称 | 确认提币页面 |
| 版本 | 1.1 |
| 更新日期 | 2025-12-08 |
| 状态 | 草稿 |

### 功能描述
用户最终确认提币信息，包括币种、网络、提币地址、提币数量、手续费和实际到账金额，确认无误后提交提币申请。

---

## 2. UI组件

### 2.1 组件详情

| 组件 | 类型 | 描述 | 位置 |
|------|------|------|------|
| 返回按钮 | 图标按钮 | 左箭头 | 左上角 |
| 页面标题 | 文本标签 | "确认提币" | 标题栏中央 |
| 提币信息卡片 | 信息卡片 | 深色背景卡片 | 页面上部 |
| 提币信息标题 | 文本标签 | "提币信息" | 卡片顶部 |
| 币种行 | 信息行 | "币种: 1222.05 USDT" | 卡片内第1行 |
| 网络行 | 信息行 | "网络: 1222.05 USDT" | 卡片内第2行 |
| 提币地址行 | 信息行 | "提币地址: **完整地址显示，不截断**"，带复制图标，前6位和后6位高亮显示 | 卡片内第3行 |
| 提币数量行 | 信息行 | "提币数量: 1222.05 USDT" | 卡片内第4行 |
| 手续费行 | 信息行 | "手续费: 1 USDT" | 卡片内第5行 |
| 实际到账行 | 信息行 | "实际到账: 1221.05 USDT"黄绿色 | 卡片内第6行 |
| 安全提示卡片 | 提示卡片 | 带勾选图标，深色背景 | 底部区域 |
| 提示标题 | 文本标签 | "安全提示" | 提示卡片顶部 |
| 提示内容 | 文本标签 | "请仔细核对提币地址，转账后无法撤销" | 提示标题下方 |
| 确认按钮 | 主按钮 | "确认"黄绿色按钮 | 页面底部 |

---

## 3. 功能需求

### FR-CW-019-01: 提币信息展示

| 字段 | 内容 |
|------|------|
| **ID** | FR-CW-019-01 |
| **描述** | 完整展示提币的所有关键信息 |
| **验收标准** | 1. **假设** 进入确认页面, **当** 加载, **则** 显示币种、网络、提币地址、提币数量、手续费、实际到账所有字段<br>2. **假设** 显示信息, **当** 渲染, **则** 所有数据与上一步输入的信息完全一致<br>3. **假设** 实际到账金额, **当** 显示, **则** 使用黄绿色突出显示 |
| **优先级** | 必须 |

### FR-CW-019-02: 复制地址

| 字段 | 内容 |
|------|------|
| **ID** | FR-CW-019-02 |
| **描述** | 用户可以复制提币地址进行最后确认 |
| **验收标准** | 1. **假设** 用户点击地址复制图标, **当** 触发, **则** 复制完整提币地址到剪贴板<br>2. **假设** 复制成功, **当** 完成, **则** 显示"已复制"提示 |
| **优先级** | 应该 |

### FR-CW-019-03: 安全提示

| 字段 | 内容 |
|------|------|
| **ID** | FR-CW-019-03 |
| **描述** | 显示安全提示警告用户谨慎操作 |
| **验收标准** | 1. **假设** 显示安全提示, **当** 渲染, **则** 使用勾选图标和深色卡片突出显示<br>2. **假设** 提示内容, **当** 显示, **则** 明确告知"转账后无法撤销"等关键信息 |
| **优先级** | 必须 |

### FR-CW-019-04: 确认提交

| 字段 | 内容 |
|------|------|
| **ID** | FR-CW-019-04 |
| **描述** | 用户最终确认并提交提币申请 |
| **验收标准** | 1. **假设** 用户点击"确认"按钮, **当** 触发, **则** 提交提币申请到服务器<br>2. **假设** 提交成功, **当** 完成, **则** 跳转到提交成功页面<br>3. **假设** 提交失败, **当** 返回错误, **则** 显示错误提示（如"余额不足"、"网络错误"等） |
| **优先级** | 必须 |

### FR-CW-019-05: 二次确认对话框

| 字段 | 内容 |
|------|------|
| **ID** | FR-CW-019-05 |
| **描述** | 点击确认后弹出二次确认对话框 |
| **验收标准** | 1. **假设** 用户点击"确认"按钮, **当** 触发, **则** 弹出二次确认对话框<br>2. **假设** 对话框显示, **当** 渲染, **则** 再次提示用户确认提币信息<br>3. **假设** 用户在对话框点击确认, **当** 触发, **则** 真正提交申请<br>4. **假设** 用户在对话框点击取消, **当** 触发, **则** 关闭对话框返回确认页面 |
| **优先级** | 应该 |

### FR-CW-019-06: 完整地址显示（安全关键）

| 字段 | 内容 |
|------|------|
| **ID** | FR-CW-019-06 |
| **描述** | 确认页面**必须**显示完整提币地址，不得截断，以便用户核对 |
| **验收标准** | 1. **假设** 确认页面显示地址，**当** 渲染，**则** 显示完整地址（不使用省略号截断）<br>2. **假设** 地址较长，**当** 显示，**则** 地址可换行显示，但保持完整<br>3. **假设** 地址显示，**当** 高亮，**则** 前6位和后6位字符使用不同颜色高亮以便核对<br>4. **假设** 用户需要核对，**当** 查看地址，**则** 字体大小足够清晰可读（至少14pt） |
| **优先级** | **必须（安全关键）** |

> **安全说明**：截断显示的地址无法让用户完整核对，可能导致因恶意软件篡改地址或复制错误而将资金发送到错误地址。

### FR-CW-019-07: 交易取消倒计时（安全关键）

| 字段 | 内容 |
|------|------|
| **ID** | FR-CW-019-07 |
| **描述** | 用户点击最终确认后，提供30秒倒计时窗口允许取消交易 |
| **验收标准** | 1. **假设** 用户在二次确认对话框点击确认，**当** 开始提交，**则** 显示30秒倒计时界面<br>2. **假设** 倒计时显示，**当** 用户查看，**则** 显示大号"取消"按钮和倒计时数字<br>3. **假设** 用户在倒计时内点击取消，**当** 触发，**则** 取消交易，返回确认页面<br>4. **假设** 倒计时结束，**当** 30秒到期，**则** 正式提交交易到区块链<br>5. **假设** 交易已提交，**当** 倒计时结束后，**则** 显示明确提示"交易已提交，无法撤销" |
| **优先级** | **必须（安全关键）** |

> **安全说明**：链上交易一旦广播无法撤回。30秒取消窗口给用户最后的反悔机会，防止误操作导致资金丢失。

### FR-CW-019-08: 不可撤销警告

| 字段 | 内容 |
|------|------|
| **ID** | FR-CW-019-08 |
| **描述** | 在确认页面和二次确认对话框中明确警告交易不可撤销 |
| **验收标准** | 1. **假设** 安全提示显示，**当** 渲染，**则** 包含红色警告文字"链上转账一旦完成无法撤销"<br>2. **假设** 二次确认对话框显示，**当** 用户查看，**则** 显示醒目警告"确认后资金将无法追回"<br>3. **假设** 警告显示，**当** 渲染，**则** 使用红色或橙色警示颜色 |
| **优先级** | **必须** |

---

## 4. 用户交互

### 4.1 用户工作流
1. 用户从提币详情页点击"下一步"
2. 进入确认提币页面
3. 仔细核对所有提币信息
4. 可选：复制地址再次确认
5. 阅读安全提示
6. 点击"确认"按钮
7. （可选）二次确认对话框
8. 提交申请成功，跳转到成功页面

### 4.2 导航流程
- 提币详情页 → 确认提币页面
- 确认提币页面 → 提交成功页面

### 4.3 手势与交互
- **点击**：复制图标、确认按钮
- **滚动**：页面内容支持垂直滚动

---

## 5. 数据需求

### 5.1 显示数据

| 数据项 | 数据类型 | 来源 | 说明 |
|--------|---------|------|------|
| 币种 | String | 上一步 | 如"USDT" |
| 网络 | String | 上一步 | 如"Tron(TRC20)" |
| 提币地址 | String | 上一步 | 完整区块链地址 |
| 提币数量 | Decimal | 上一步 | 用户输入的数量 |
| 手续费 | Decimal | 系统计算 | 网络手续费 |
| 实际到账 | Decimal | 系统计算 | 提币数量 - 手续费 |

### 5.2 提交数据结构

```json
{
  "coinId": "USDT",
  "network": "TRC20",
  "toAddress": "0x1e39c3f48...",
  "amount": "1222.05",
  "fee": "1",
  "actualAmount": "1221.05"
}
```

---

## 6. 验证规则

- 地址显示：完整地址（可省略中间部分）
- 金额显示：使用千位分隔符
- 实际到账：黄绿色突出显示

---

## 7. 验收标准汇总

1. ✅ 所有提币信息准确显示
2. ✅ 信息与上一步输入完全一致
3. ✅ 复制地址功能正常
4. ✅ 安全提示清晰展示
5. ✅ 确认按钮功能正常
6. ✅ 提交成功正确跳转
7. ✅ 提交失败显示明确错误
8. ✅ 二次确认对话框功能正常（如有）
9. ✅ UI符合设计稿
10. ✅ **提币地址完整显示，不截断**
11. ✅ **地址前6位和后6位高亮显示**
12. ✅ **30秒取消倒计时正常工作**
13. ✅ **倒计时内可成功取消交易**
14. ✅ **不可撤销警告使用红色/橙色显示**
15. ✅ **二次确认对话框包含资金警告**

---

## 8. 无障碍访问要求

- [ ] 所有文本颜色对比度符合WCAG 2.1 AA标准（最低4.5:1）
- [ ] 按钮和可交互元素最小触摸目标为44x44pt
- [ ] 支持屏幕阅读器，所有UI元素有适当的无障碍标签
- [ ] 提币信息卡片支持屏幕阅读器逐项朗读
- [ ] 完整地址可通过辅助技术完整朗读
- [ ] 倒计时状态变化通过无障碍公告通知用户（aria-live="assertive"）
- [ ] 警告信息使用role="alert"标记
- [ ] 对话框获得焦点，支持Escape键关闭
- [ ] 支持键盘导航（适用于平板/桌面设备）
