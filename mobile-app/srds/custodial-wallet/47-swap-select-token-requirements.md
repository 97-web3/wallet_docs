# 闪兑-选择代币页面 - 软件需求规格说明书

## 1. 页面标识

| 属性 | 值 |
|------|-----|
| 页面ID | CW-047 |
| 页面名称 | 闪兑-选择代币页面 |
| 版本 | 1.0 |
| 更新日期 | 2025-12-09 |
| 状态 | 草稿 |

### 功能描述

用户进入闪兑功能的入口页面，选择要兑换的源代币和目标代币。支持链内代币兑换，采用 DEX 聚合器获取最优汇率。

> 相关规格: [COMMON-001 代币精度规则](../common/token-precision-rules.md) | [COMMON-003 区块链网络规格](../common/blockchain-networks.md) | [COMMON-006 术语表](../common/glossary.md)

### V1.0 支持的网络

| 网络 | 代币标准 | DEX |
|------|----------|-----|
| TRX (Tron) | TRC-20 | SunSwap |
| BNB (BSC) | BEP-20 | PancakeSwap |
| ETH (Ethereum) | ERC-20 | Uniswap |

---

## 2. UI组件

### 2.1 布局概述

页面采用垂直布局，顶部导航栏，中部为代币选择区域（源代币 + 目标代币），底部为下一步按钮。整体采用深色主题。

### 2.2 组件详情

| 组件 | 类型 | 描述 | 位置 |
|------|------|------|------|
| 返回按钮 | 图标按钮 | 左箭头，返回上一页 | 左上角 |
| 页面标题 | 文本标签 | "闪兑" | 标题栏中央 |
| 网络选择器 | 下拉选择 | 选择当前操作的区块链网络 | 标题栏下方 |
| 源代币卡片 | 卡片组件 | 显示"支付"标签和源代币信息 | 中上部 |
| 源代币图标 | 图片 | 代币 Logo | 卡片左侧 |
| 源代币名称 | 文本标签 | 代币符号（如 USDT） | 图标右侧 |
| 源代币余额 | 文本标签 | "余额: xxx" | 卡片右侧 |
| 选择按钮 | 图标按钮 | 下拉箭头，点击选择代币 | 卡片右侧 |
| 交换按钮 | 图标按钮 | 双向箭头，交换源/目标代币 | 两卡片之间 |
| 目标代币卡片 | 卡片组件 | 显示"获得"标签和目标代币信息 | 中下部 |
| 目标代币图标 | 图片 | 代币 Logo | 卡片左侧 |
| 目标代币名称 | 文本标签 | 代币符号 | 图标右侧 |
| 选择按钮 | 图标按钮 | 下拉箭头，点击选择代币 | 卡片右侧 |
| 下一步按钮 | 主按钮 | "下一步"，荧光绿色背景 | 底部 |

---

## 3. 功能需求

### FR-CW-047-01: 网络选择

| 字段 | 内容 |
|------|------|
| **ID** | FR-CW-047-01 |
| **描述** | 用户选择要进行闪兑的区块链网络 |
| **验收标准** | 1. **假设** 用户进入闪兑页面, **当** 加载完成, **则** 默认显示用户上次使用的网络<br>2. **假设** 用户点击网络选择器, **当** 弹出选项, **则** 显示 TRX/BNB/ETH 三个网络选项<br>3. **假设** 用户切换网络, **当** 选择新网络, **则** 清空已选代币并加载该网络的代币列表 |
| **优先级** | 必须 |

### FR-CW-047-02: 选择源代币

| 字段 | 内容 |
|------|------|
| **ID** | FR-CW-047-02 |
| **描述** | 用户选择要支付的代币 |
| **验收标准** | 1. **假设** 用户点击源代币卡片, **当** 触发, **则** 弹出代币选择列表<br>2. **假设** 代币列表显示, **当** 渲染, **则** 显示代币图标、名称、余额，按余额降序排列<br>3. **假设** 用户选择代币, **当** 点击, **则** 更新源代币卡片显示<br>4. **假设** 源代币余额为0, **当** 选择, **则** 允许选择但下一步时提示余额不足 |
| **优先级** | 必须 |

### FR-CW-047-03: 选择目标代币

| 字段 | 内容 |
|------|------|
| **ID** | FR-CW-047-03 |
| **描述** | 用户选择要获得的代币 |
| **验收标准** | 1. **假设** 用户点击目标代币卡片, **当** 触发, **则** 弹出代币选择列表<br>2. **假设** 代币列表显示, **当** 渲染, **则** 自动排除已选的源代币<br>3. **假设** 用户选择代币, **当** 点击, **则** 更新目标代币卡片显示 |
| **优先级** | 必须 |

### FR-CW-047-04: 交换代币位置

| 字段 | 内容 |
|------|------|
| **ID** | FR-CW-047-04 |
| **描述** | 用户可快速交换源代币和目标代币 |
| **验收标准** | 1. **假设** 两个代币都已选择, **当** 点击交换按钮, **则** 源代币和目标代币位置互换<br>2. **假设** 仅选择一个代币, **当** 点击交换按钮, **则** 该代币移至另一位置 |
| **优先级** | 应该 |

### FR-CW-047-05: 进入下一步

| 字段 | 内容 |
|------|------|
| **ID** | FR-CW-047-05 |
| **描述** | 验证选择并进入闪兑详情页 |
| **验收标准** | 1. **假设** 源代币和目标代币都已选择, **当** 点击下一步, **则** 跳转至闪兑详情页 (CW-048)<br>2. **假设** 未选择完整, **当** 点击下一步, **则** 提示"请选择代币"<br>3. **假设** 源代币余额为0, **当** 点击下一步, **则** 提示"余额不足" |
| **优先级** | 必须 |

---

## 4. 用户交互

### 4.1 用户工作流

1. 用户从钱包首页点击"闪兑"按钮进入
2. 选择区块链网络（默认上次使用的网络）
3. 点击源代币卡片，选择要支付的代币
4. 点击目标代币卡片，选择要获得的代币
5. （可选）点击交换按钮互换代币位置
6. 点击"下一步"进入闪兑详情页

### 4.2 导航流程

```
钱包首页 → 闪兑选择代币 (CW-047) → 闪兑详情 (CW-048)
                ↓
         点击返回 → 钱包首页
```

### 4.3 手势操作

- 点击代币卡片：弹出代币选择列表
- 点击交换按钮：动画交换两个代币位置
- 下拉刷新：刷新代币余额

---

## 5. 数据需求

### 5.1 显示数据

| 数据项 | 数据类型 | 说明 |
|--------|---------|------|
| 网络列表 | Array | TRX/BNB/ETH |
| 代币列表 | Array | 当前网络支持的代币 |
| 代币图标 | Image URL | 代币 Logo |
| 代币符号 | String | 如 USDT、ETH |
| 代币余额 | Decimal | 7位小数精度 |

### 5.2 输入数据

| 字段名称 | 数据类型 | 必填 | 说明 |
|---------|---------|------|------|
| 选择的网络 | String | 是 | TRX/BNB/ETH |
| 源代币 | Object | 是 | 代币信息对象 |
| 目标代币 | Object | 是 | 代币信息对象 |

---

## 6. 验证规则

### 6.1 业务规则

| 规则 | 说明 |
|------|------|
| 同币种限制 | 源代币和目标代币不能相同 |
| 网络限制 | 仅支持链内兑换，不支持跨链 |
| 代币支持 | 仅显示 Admin 后台配置为"启用"的代币对 |

### 6.2 错误处理

| 场景 | 提示 |
|------|------|
| 未选择代币 | "请选择代币" |
| 源代币余额为0 | "余额不足" |
| 网络加载失败 | "网络连接失败，请重试" |
| 代币列表为空 | "当前网络暂无可兑换代币" |

---

## 7. 技术考虑

### 7.1 性能要求

- 代币列表加载时间 < 2秒
- 余额数据缓存 30 秒

### 7.2 API 集成

| 接口 | 说明 |
|------|------|
| 获取支持的代币列表 | 按网络获取可兑换的代币 |
| 获取代币余额 | 批量获取用户持有的代币余额 |
| 获取代币价格 | 用于显示法币价值 |

### 7.3 状态管理

需要管理的状态：
- 当前选择的网络
- 源代币信息
- 目标代币信息
- 代币列表数据
- 加载状态

---

## 8. 验收标准汇总

1. ✅ 页面正确显示网络选择器和代币选择卡片
2. ✅ 可成功选择源代币和目标代币
3. ✅ 交换按钮功能正常
4. ✅ 代币列表按余额降序排列
5. ✅ 源代币和目标代币不能相同
6. ✅ 余额为0时有正确提示
7. ✅ 网络切换后代币列表正确刷新
8. ✅ 下一步跳转正常
9. ✅ UI 符合设计稿

---

## 9. 无障碍访问要求

- [ ] 所有图标有无障碍标签
- [ ] 按钮最小触摸目标 44x44pt
- [ ] 颜色对比度符合 WCAG 2.1 AA 标准
- [ ] 支持屏幕阅读器

---

*文档创建日期: 2025-12-09*
