# 通讯录(内部) - 软件需求规格说明书

## 1. 页面标识

| 属性 | 值 |
|------|-----|
| 页面ID | CW-037 |
| 页面名称 | 通讯录(内部) |
| 版本 | 1.0 |
| 更新日期 | 2025-12-08 |
| 状态 | 草稿 |

### 功能描述
通讯录内部页面显示用户保存的内部转账收款方列表。内部转账指平台内用户之间的转账，使用用户ID或手机号而非区块链地址。页面支持搜索、选择收款方，以及添加新的内部联系人。

---

## 2. UI组件

### 2.1 布局概述
页面采用列表布局，深色背景主题。顶部显示导航栏和搜索框，中间是联系人列表，每个联系人显示头像、用户名/昵称和手机号。底部可能有添加联系人按钮。

### 2.2 组件详情

| 组件 | 类型 | 描述 | 位置 |
|------|------|------|------|
| 返回按钮 | 图标按钮 | 左箭头，返回上一页 | 顶部左侧 |
| 页面标题 | 标签 | "选择收款方"或"通讯录" | 顶部居中 |
| 搜索框 | 文本输入 | 搜索联系人 | 标题下方 |
| 联系人列表 | 列表 | 已保存的内部联系人 | 内容区域 |
| 联系人项 | 列表项 | 头像、用户名、手机号 | 列表中 |
| 选中指示 | 图标 | 绿色勾选，表示已选中 | 列表项右侧 |
| 添加联系人按钮 | 文字按钮 | "+添加新联系人" | 列表底部或顶部 |
| 空状态提示 | 标签/图片 | 无联系人时显示 | 内容区域 |

---

## 3. 功能需求

### FR-037-01: 显示内部联系人列表

| 字段 | 内容 |
|------|------|
| **ID** | FR-037-01 |
| **描述** | 系统应显示用户保存的所有内部转账联系人 |
| **验收标准** | 1. **假设** 用户有保存的联系人，**当** 打开通讯录，**则** 显示联系人列表<br>2. **假设** 每个联系人项，**当** 显示详情，**则** 包含头像、用户名和手机号 |
| **优先级** | 必须 |

### FR-037-02: 搜索联系人

| 字段 | 内容 |
|------|------|
| **ID** | FR-037-02 |
| **描述** | 用户可以通过搜索框筛选联系人 |
| **验收标准** | 1. **假设** 用户在搜索框输入，**当** 输入关键词，**则** 列表实时过滤匹配结果<br>2. **假设** 搜索无匹配，**当** 显示结果，**则** 提示"未找到联系人" |
| **优先级** | 应该 |

### FR-037-03: 选择联系人

| 字段 | 内容 |
|------|------|
| **ID** | FR-037-03 |
| **描述** | 用户可以从列表中选择收款方 |
| **验收标准** | 1. **假设** 用户点击联系人项，**当** 选择确认，**则** 该联系人被选中<br>2. **假设** 联系人被选中，**当** 返回上一页，**则** 收款方信息被填入 |
| **优先级** | 必须 |

### FR-037-04: 添加新联系人

| 字段 | 内容 |
|------|------|
| **ID** | FR-037-04 |
| **描述** | 用户可以添加新的内部转账联系人 |
| **验收标准** | 1. **假设** 用户点击添加按钮，**当** 进入添加页面，**则** 可以输入联系人信息<br>2. **假设** 添加成功，**当** 返回列表，**则** 新联系人显示在列表中 |
| **优先级** | 应该 |

### FR-037-05: 空状态处理

| 字段 | 内容 |
|------|------|
| **ID** | FR-037-05 |
| **描述** | 无联系人时应显示空状态提示 |
| **验收标准** | 1. **假设** 用户没有保存联系人，**当** 打开通讯录，**则** 显示空状态插图和提示<br>2. **假设** 显示空状态，**当** 提供引导，**则** 引导用户添加第一个联系人 |
| **优先级** | 应该 |

---

## 4. 用户交互

### 4.1 用户工作流
1. 用户从编辑收款方页面进入通讯录
2. 查看已保存的内部联系人
3. 可选：搜索筛选联系人
4. 点击选择收款方
5. 返回上一页，联系人信息被填入

### 4.2 导航流程
- **来源页面**: 编辑收款方页面（内部转账）
- **目标页面**:
  - 选择联系人: 返回来源页面
  - 添加联系人: 添加联系人页面
  - 取消: 返回来源页面

### 4.3 手势与交互
| 手势 | 行为 |
|------|------|
| 点击搜索框 | 激活搜索输入 |
| 输入搜索词 | 实时过滤列表 |
| 点击联系人项 | 选择该联系人 |
| 点击添加按钮 | 进入添加页面 |
| 上下滑动 | 滚动列表 |

---

## 5. 数据需求

### 5.1 显示数据
| 数据字段 | 类型 | 来源 | 格式 |
|----------|------|------|------|
| 联系人列表 | Array | 本地存储/服务器 | 联系人对象数组 |
| 头像 | Image | 联系人数据 | URL或本地图片 |
| 用户名 | String | 联系人数据 | 用户昵称 |
| 手机号 | String | 联系人数据 | 部分隐藏显示 |
| 用户ID | String | 联系人数据 | 内部转账标识 |

### 5.2 输入数据
| 输入字段 | 类型 | 验证规则 | 必填 |
|----------|------|----------|------|
| 搜索关键词 | String | 无特殊限制 | 否 |

---

## 6. 验证规则

### 6.1 搜索规则
- 支持用户名模糊匹配
- 支持手机号匹配
- 实时过滤，无需点击搜索

### 6.2 选择验证
- 选择的联系人必须为有效用户
- 内部转账收款方必须在平台注册

---

## 7. 技术考虑

### 7.1 数据加载
- 首次加载从服务器获取联系人列表
- 本地缓存减少重复请求
- 支持下拉刷新

### 7.2 搜索优化
- 本地搜索实现实时过滤
- 搜索防抖处理
- 大列表考虑分页加载

### 7.3 状态同步
- 联系人信息变化时更新显示
- 选择后正确传递数据给来源页面

---

## 8. 验收标准汇总

- [ ] 正确显示已保存的联系人列表
- [ ] 联系人项显示头像、用户名、手机号
- [ ] 搜索框可以筛选联系人
- [ ] 点击联系人可以选择
- [ ] 选择后正确返回并传递数据
- [ ] 添加联系人按钮正常工作
- [ ] 无联系人时显示空状态
- [ ] 返回按钮正常工作
