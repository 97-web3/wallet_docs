# 重新发送 - 软件需求规格说明书

## 1. 页面标识

| 属性 | 值 |
|------|-----|
| 页面ID | CW-041 |
| 页面名称 | 重新发送按钮组件 |
| 版本 | 1.0 |
| 更新日期 | 2025-12-08 |
| 状态 | 草稿 |

### 功能描述
重新发送验证码的按钮组件，深色绿色背景的圆角按钮，显示"重新发送"文字。当验证码倒计时结束后，此按钮变为可点击状态，允许用户重新获取验证码。

---

## 2. UI组件

### 2.1 布局概述
独立的按钮组件，深色绿色背景，白色文字，圆角矩形设计。

### 2.2 组件详情

| 组件 | 类型 | 描述 | 位置 |
|------|------|------|------|
| 按钮容器 | 按钮 | 深色绿色背景，圆角矩形 | 验证码输入框右侧 |
| 按钮文字 | 文本 | "重新发送"，白色文字 | 按钮中央 |

---

## 3. 功能需求

### FR-041-01: 重新发送功能

| 字段 | 内容 |
|------|------|
| **ID** | FR-041-01 |
| **描述** | 用户点击按钮重新发送验证码 |
| **验收标准** | 1. **假设** 倒计时结束, **当** 按钮变为"重新发送", **则** 用户可以点击按钮<br>2. **假设** 用户点击按钮, **当** 点击, **则** 向服务器发送新的验证码请求<br>3. **假设** 发送成功, **当** 收到确认, **则** 按钮重新开始倒计时（如"60s"）<br>4. **假设** 发送失败, **当** 出错, **则** 显示错误提示并保持"重新发送"状态 |
| **优先级** | 必须 |

### FR-041-02: 按钮状态管理

| 字段 | 内容 |
|------|------|
| **ID** | FR-041-02 |
| **描述** | 按钮在倒计时和可点击之间切换 |
| **验收标准** | 1. **假设** 倒计时进行中, **当** 显示秒数, **则** 按钮禁用无法点击<br>2. **假设** 倒计时结束, **当** 到达0秒, **则** 按钮文字变为"重新发送"并变为可点击<br>3. **假设** 点击重新发送, **当** 发送请求中, **则** 按钮显示加载状态或禁用 |
| **优先级** | 必须 |

### FR-041-03: 发送频率限制

| 字段 | 内容 |
|------|------|
| **ID** | FR-041-03 |
| **描述** | 限制验证码发送频率防止滥用 |
| **验收标准** | 1. **假设** 用户频繁点击, **当** 超过限制（如5次/小时）, **则** 显示"发送次数过多，请稍后重试"<br>2. **假设** 触发限制, **当** 按钮禁用, **则** 显示剩余等待时间<br>3. **假设** 等待时间结束, **当** 限制解除, **则** 按钮重新可用 |
| **优先级** | 必须 |

### FR-041-04: 验证码发送确认

| 字段 | 内容 |
|------|------|
| **ID** | FR-041-04 |
| **描述** | 发送成功后提供反馈 |
| **验收标准** | 1. **假设** 验证码发送成功, **当** 收到确认, **则** 显示Toast提示"验证码已发送"<br>2. **假设** 用户查看邮箱, **当** 检查, **则** 应该收到新的验证码邮件 |
| **优先级** | 必须 |

---

## 4. 用户交互

### 4.1 用户工作流

```
倒计时结束 → 按钮变为"重新发送" → 用户点击 → 发送验证码 → 开始新倒计时
                                            ↓
                                    发送失败：显示错误，保持可点击
```

### 4.2 导航流程

- **状态**: 按钮在倒计时和可点击状态之间切换
- **操作**: 点击发送验证码，无页面跳转

### 4.3 手势与交互

- **点击按钮**: 重新发送验证码
- **倒计时中**: 按钮禁用无法点击
- **可点击状态**: 按钮高亮可点击

---

## 5. 数据需求

### 5.1 显示数据

| 数据项 | 类型 | 来源 | 说明 |
|--------|------|------|------|
| 按钮文字 | 字符串 | 前端逻辑 | "重新发送"或倒计时秒数 |
| 按钮状态 | 枚举 | 前端逻辑 | 可点击/禁用/加载中 |
| 剩余次数 | 整数 | 服务器/前端 | 还可以发送的次数 |

### 5.2 输入数据

| 数据项 | 类型 | 必填 | 验证规则 | 说明 |
|--------|------|------|----------|------|
| 接收邮箱/手机 | 字符串 | 是 | 格式验证 | 验证码接收目标 |

### 5.3 输出数据

| 数据项 | 类型 | 目标 | 说明 |
|--------|------|------|------|
| 发送请求 | 对象 | 服务器 | 包含接收方式、类型等信息 |

---

## 6. 验证规则

### 6.1 倒计时规则

- 初次发送后倒计时60秒
- 倒计时期间按钮禁用
- 倒计时结束变为可点击

### 6.2 频率限制规则

- 5次/小时
- 10次/天
- 超过限制后显示等待时间

### 6.3 业务规则

- 验证码有效期5分钟
- 同一设备/IP限制发送频率
- 异常频繁触发风控机制

---

## 7. 技术考虑

### 7.1 倒计时实现

- 使用JavaScript定时器
- 页面切换时保持倒计时状态
- 倒计时存储在本地避免刷新重置

### 7.2 防刷机制

- 前端限制点击频率
- 后端验证发送频率
- IP级别的限制
- 设备指纹识别

### 7.3 用户体验

- 按钮状态清晰明显
- 倒计时数字实时更新
- 发送成功提供反馈
- 发送失败友好提示

### 7.4 错误处理

- 网络错误：提示重试
- 频率限制：显示等待时间
- 邮箱/手机无效：提示修正
- 服务器错误：显示通用错误信息

---

## 8. 验收标准汇总

### 8.1 功能验收

- [ ] 重新发送功能正常
- [ ] 按钮状态正确切换
- [ ] 发送频率限制有效
- [ ] 发送确认反馈及时

### 8.2 倒计时验收

- [ ] 倒计时准确无误
- [ ] 页面切换保持状态
- [ ] 倒计时结束正确触发

### 8.3 用户体验验收

- [ ] 按钮状态视觉明显
- [ ] 点击响应迅速
- [ ] 错误提示清晰
- [ ] 成功反馈及时

### 8.4 安全验收

- [ ] 防刷机制有效
- [ ] 频率限制正常工作
- [ ] 异常检测准确
