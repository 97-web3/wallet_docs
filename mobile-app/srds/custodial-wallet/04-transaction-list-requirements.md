# 交易记录列表页面 - 软件需求规格说明书

## 1. 页面标识

| 属性 | 值 |
|------|-----|
| 页面ID | CW-004 |
| 页面名称 | 交易记录列表页面 |
| 版本 | 1.2 |
| 更新日期 | 2025-12-08 |
| 状态 | 草稿 |

### 功能描述
显示用户所有币种的交易记录，支持按交易类型筛选（全部/充值/提现/内部划转），用户可以查看所有交易历史并进入详情页。

> 相关规格: [COMMON-001 代币精度规则](../common/token-precision-rules.md)

### 交易状态定义
| 状态 | 英文 | 说明 | 颜色 |
|------|------|------|------|
| 已发起 | Initiated | 用户提交，等待处理 | 灰色 |
| 交易中 | Processing | 正在处理/链上确认中 | 黄色 |
| 已完成 | Completed | 交易成功 | 绿色 |
| 已驳回 | Rejected | 审批未通过（仅内部划转） | 红色 |

---

## 2. UI组件

### 2.1 布局概述
深色主题界面，顶部为页面标题和返回按钮，下方为交易类型筛选Tab，主体为按日期分组的交易记录列表。

### 2.2 组件详情

| 组件 | 类型 | 描述 | 位置 |
|------|------|------|------|
| 返回按钮 | 图标按钮 | 左箭头图标 | 左上角 |
| 页面标题 | 文本标签 | "交易记录" | 标题栏中央 |
| 筛选Tab组 | Tab切换器 | 包含"全部"、"充值"、"提现"三个Tab | 标题下方 |
| 全部Tab | Tab按钮 | 绿色边框高亮状态 | 筛选Tab组左侧 |
| 充值Tab | Tab按钮 | 深色背景未选中状态 | 筛选Tab组中间 |
| 提现Tab | Tab按钮 | 深色背景未选中状态 | 筛选Tab组右侧 |
| 日期分隔符 | 文本标签 | 如"2025/11/14" | 各交易分组上方 |
| 交易记录项 | 列表卡片 | 显示币种、交易类型、地址、金额、状态 | 日期分隔符下方 |

### 2.3 交易记录项组件

| 组件 | 类型 | 描述 |
|------|------|------|
| 币种图标 | 图片 | 圆形币种Logo（USDT/BTC/ETH等） |
| 交易类型 | 文本标签 | "充值"或"提现" |
| 地址信息 | 文本标签 | "来自/至 地址..." 灰色小字 |
| 交易金额 | 数字显示 | 如"+123,00 USDT"或"-123,00 BTC" |
| 交易状态 | 状态标签 | "已完成"绿色或"处理中"橙色 |

---

## 3. 功能需求

### FR-CW-004-01: 交易记录显示

| 字段 | 内容 |
|------|------|
| **ID** | FR-CW-004-01 |
| **描述** | 按日期倒序显示用户所有交易记录 |
| **验收标准** | 1. **假设** 用户有交易记录, **当** 进入页面, **则** 按日期倒序显示所有交易<br>2. **假设** 同一天有多笔交易, **当** 显示记录, **则** 这些交易在同一日期分组下<br>3. **假设** 用户没有交易记录, **当** 加载列表, **则** 显示"暂无交易记录"提示 |
| **优先级** | 必须 |

### FR-CW-004-02: 交易类型筛选

| 字段 | 内容 |
|------|------|
| **ID** | FR-CW-004-02 |
| **描述** | 用户可以按交易类型筛选记录 |
| **验收标准** | 1. **假设** 用户点击"全部"Tab, **当** 触发点击, **则** 显示所有类型的交易记录<br>2. **假设** 用户点击"充值"Tab, **当** 触发点击, **则** 只显示充值类型的交易记录<br>3. **假设** 用户点击"提现"Tab, **当** 触发点击, **则** 只显示提现类型的交易记录<br>4. **假设** 切换Tab, **当** 筛选条件改变, **则** 高亮显示当前选中的Tab（绿色边框） |
| **优先级** | 必须 |

### FR-CW-004-03: 多币种支持

| 字段 | 内容 |
|------|------|
| **ID** | FR-CW-004-03 |
| **描述** | 交易记录列表支持显示多种加密货币的交易 |
| **验收标准** | 1. **假设** 用户有多种币种的交易, **当** 显示列表, **则** 显示所有币种的交易记录<br>2. **假设** 显示不同币种, **当** 渲染列表项, **则** 显示对应币种的图标和名称<br>3. **假设** 交易金额, **当** 显示时, **则** 附带对应的币种单位（如USDT、BTC、ETH） |
| **优先级** | 必须 |

### FR-CW-004-04: 交易详情入口

| 字段 | 内容 |
|------|------|
| **ID** | FR-CW-004-04 |
| **描述** | 用户可以点击交易记录查看详情 |
| **验收标准** | 1. **假设** 用户点击某条交易记录, **当** 触发点击, **则** 跳转到该交易的详情页面<br>2. **假设** 进入详情页, **当** 加载完成, **则** 显示完整的交易信息（ID、时间、金额、状态、哈希等） |
| **优先级** | 必须 |

### FR-CW-004-05: 分页加载

| 字段 | 内容 |
|------|------|
| **ID** | FR-CW-004-05 |
| **描述** | 交易记录支持分页加载 |
| **验收标准** | 1. **假设** 交易记录较多, **当** 用户滚动到列表底部, **则** 自动加载下一页数据<br>2. **假设** 正在加载数据, **当** 加载中, **则** 显示加载指示器<br>3. **假设** 已加载全部数据, **当** 到达底部, **则** 显示"没有更多数据"提示 |
| **优先级** | 必须 |

### FR-CW-004-06: 交易状态显示

| 字段 | 内容 |
|------|------|
| **ID** | FR-CW-004-06 |
| **描述** | 清晰显示每笔交易的状态（已发起→交易中→已完成） |
| **验收标准** | 1. **假设** 交易刚提交, **当** 显示状态, **则** 显示灰色"已发起"标签<br>2. **假设** 交易处理中, **当** 显示状态, **则** 显示黄色"交易中"标签<br>3. **假设** 交易成功, **当** 显示状态, **则** 显示绿色"已完成"标签<br>4. **假设** 内部划转被驳回, **当** 显示状态, **则** 显示红色"已驳回"标签 |
| **优先级** | 必须 |

### FR-CW-004-07: 地址显示

| 字段 | 内容 |
|------|------|
| **ID** | FR-CW-004-07 |
| **描述** | 显示交易的地址信息 |
| **验收标准** | 1. **假设** 交易类型为充值, **当** 显示地址, **则** 显示"来自 地址..."<br>2. **假设** 交易类型为提现, **当** 显示地址, **则** 显示"至 地址..."<br>3. **假设** 地址较长, **当** 显示地址, **则** 省略中间部分，保留前后各若干位字符 |
| **优先级** | 必须 |

### FR-CW-004-08: 交易搜索功能（增强）

| 字段 | 内容 |
|------|------|
| **ID** | FR-CW-004-08 |
| **描述** | 用户可以搜索特定交易 |
| **验收标准** | 1. **假设** 用户需要搜索，**当** 点击搜索图标，**则** 展开搜索输入框<br>2. **假设** 用户输入搜索内容，**当** 输入地址/金额/交易ID，**则** 实时过滤匹配的交易记录<br>3. **假设** 搜索无结果，**当** 无匹配项，**则** 显示"未找到相关交易"<br>4. **假设** 搜索框为空，**当** 清空，**则** 恢复显示全部交易记录 |
| **优先级** | 应该 |

### FR-CW-004-09: 高级筛选功能

| 字段 | 内容 |
|------|------|
| **ID** | FR-CW-004-09 |
| **描述** | 提供多维度筛选条件 |
| **验收标准** | 1. **假设** 用户点击筛选按钮，**当** 打开筛选面板，**则** 显示日期范围、金额范围、状态等筛选选项<br>2. **假设** 用户设置日期范围，**当** 选择起止日期，**则** 只显示该范围内的交易<br>3. **假设** 用户设置金额范围，**当** 输入最小/最大金额，**则** 只显示该范围内的交易<br>4. **假设** 用户选择状态筛选，**当** 选择"处理中"，**则** 只显示处理中的交易 |
| **优先级** | 应该 |

### FR-CW-004-10: 交易状态解释

| 字段 | 内容 |
|------|------|
| **ID** | FR-CW-004-10 |
| **描述** | 为交易状态提供更详细的说明 |
| **验收标准** | 1. **假设** 交易状态为"处理中"，**当** 显示，**则** 附带预估时间（如"处理中，预计10分钟"）<br>2. **假设** 交易状态为"失败"，**当** 显示，**则** 附带失败原因（如"失败：余额不足"）<br>3. **假设** 用户点击状态，**当** 触发，**则** 显示详细状态说明弹窗 |
| **优先级** | 应该 |

---

## 4. 用户交互

### 4.1 用户工作流
1. 用户从主页点击"交易记录"按钮进入交易列表页
2. 默认显示"全部"类型的交易记录
3. 可选操作：
   - 切换Tab查看特定类型的交易（充值/提现）
   - 滚动列表查看历史交易
   - 上拉加载更多历史记录
   - 点击某条记录查看交易详情
   - 下拉刷新最新交易

### 4.2 导航流程
- 主页/币种详情页 → 交易记录列表页
- 交易记录列表页 → 交易详情页（点击记录项）
- 交易记录列表页 → 主页（点击返回）

### 4.3 手势与交互
- **点击**：Tab按钮、交易记录项支持点击
- **滚动**：交易记录列表支持垂直滚动
- **下拉刷新**：列表支持下拉刷新
- **上拉加载**：支持上拉加载更多历史记录

---

## 5. 数据需求

### 5.1 显示数据

| 数据项 | 数据类型 | 来源 | 更新频率 |
|--------|---------|------|---------|
| 交易记录列表 | Array | 交易服务 | 实时/下拉刷新 |
| 筛选类型 | String | 本地状态 | 用户切换 |
| 分页信息 | Object | 交易服务 | 加载更多时 |

### 5.2 交易记录数据结构

```json
{
  "transactionId": "1231231",
  "type": "deposit", // deposit, withdraw
  "coinId": "USDT",
  "coinName": "USDT",
  "coinIcon": "https://...",
  "amount": "123.00",
  "address": "0x1e39c3f480x1e39c3f480x1e39c3f480x1e3...kajs",
  "status": "completed", // completed, processing, failed
  "timestamp": "2025-11-14T12:30:00Z",
  "displayDate": "2025/11/14"
}
```

---

## 6. 验证规则

### 6.1 数据显示
- 金额使用千位分隔符
- 地址省略显示：显示前6位+...+后4位
- 日期格式：YYYY/MM/DD
- 时间格式：HH:MM:SS（详情页）

### 6.2 状态颜色
- 充值金额：绿色（+）
- 提现金额：白色（-）
- 已发起：灰色
- 交易中：黄色
- 已完成：绿色
- 已驳回：红色

### 6.3 筛选逻辑
- 全部：显示所有交易
- 充值：type = "deposit"
- 提现：type = "withdraw"

---

## 7. 技术考虑

### 7.1 性能优化
- 分页加载，每页20-30条
- 虚拟滚动优化长列表
- 图片资源缓存

### 7.2 数据刷新
- 进入页面自动加载最新数据
- 支持下拉刷新
- 处理中的交易定时刷新状态

### 7.3 错误处理
- 网络异常显示友好提示
- 加载失败可重试
- 空状态友好提示

---

## 8. 验收标准汇总

1. ✅ 交易记录按日期倒序正确显示
2. ✅ Tab筛选功能正常，切换流畅
3. ✅ 多币种交易正确显示图标和单位
4. ✅ 点击记录可进入详情页
5. ✅ 分页加载功能正常
6. ✅ 交易状态颜色显示正确
7. ✅ 地址省略显示符合规范
8. ✅ 下拉刷新功能正常
9. ✅ 空状态提示友好
10. ✅ UI完全符合设计稿
11. ✅ **搜索功能支持地址/金额/交易ID**
12. ✅ **高级筛选支持日期范围、金额范围、状态**
13. ✅ **"处理中"状态附带预估时间**
14. ✅ **"失败"状态附带失败原因**
15. ✅ **涨跌显示同时使用颜色和箭头符号（非仅颜色）**

---

## 9. 无障碍访问要求

- [ ] 所有文本颜色对比度符合WCAG 2.1 AA标准（最低4.5:1）
- [ ] 按钮和可交互元素最小触摸目标为44x44pt
- [ ] 支持屏幕阅读器，所有UI元素有适当的无障碍标签
- [ ] 交易状态不仅用颜色区分，还需有文字说明（如"已完成"、"处理中"）
- [ ] 金额增减不仅用颜色，还需使用"+"或"-"符号
- [ ] 列表项有明确的role="listitem"标记
- [ ] 搜索结果变化通过无障碍公告通知用户
- [ ] 空状态有明确的无障碍描述
- [ ] 支持键盘导航（适用于平板/桌面设备）
