# 闪兑记录页面 - 软件需求规格说明书

## 1. 页面标识

| 属性 | 值 |
|------|-----|
| 页面ID | CW-051 |
| 页面名称 | 闪兑记录页面 |
| 版本 | 1.0 |
| 更新日期 | 2025-12-09 |
| 状态 | 草稿 |

### 功能描述

展示用户的闪兑交易历史记录，支持按网络筛选、查看详情。每条记录显示交易时间、代币对、金额和状态。

> 相关规格: [COMMON-001 代币精度规则](../common/token-precision-rules.md) | [COMMON-006 术语表](../common/glossary.md)

---

## 2. UI组件

### 2.1 布局概述

页面采用列表布局，顶部导航栏带筛选器，中部为交易记录列表，支持下拉刷新和上拉加载更多。

### 2.2 组件详情

| 组件 | 类型 | 描述 | 位置 |
|------|------|------|------|
| 返回按钮 | 图标按钮 | 左箭头 | 左上角 |
| 页面标题 | 文本标签 | "闪兑记录" | 标题栏中央 |
| 筛选按钮 | 图标按钮 | 筛选图标 | 右上角 |
| 网络筛选器 | 标签组 | 全部/TRX/BNB/ETH | 导航栏下方 |
| 记录列表 | 列表组件 | 闪兑记录列表 | 中部 |
| 记录卡片 | 卡片组件 | 单条闪兑记录 | 列表项 |
| 交换图标 | 图标 | 双向箭头 | 卡片左侧 |
| 代币对标签 | 文本标签 | "USDT → ETH" | 卡片左上 |
| 状态标签 | 标签组件 | 已完成/交易中/失败 | 卡片右上 |
| 金额显示 | 文本标签 | "-100 USDT / +0.05 ETH" | 卡片中部 |
| 时间显示 | 文本标签 | "2025-12-09 14:30" | 卡片底部 |
| 空状态 | 空状态组件 | "暂无闪兑记录" | 列表为空时 |
| 加载更多 | 加载组件 | 上拉加载动画 | 列表底部 |

---

## 3. 功能需求

### FR-CW-051-01: 加载闪兑记录

| 字段 | 内容 |
|------|------|
| **ID** | FR-CW-051-01 |
| **描述** | 加载用户的闪兑交易记录 |
| **验收标准** | 1. **假设** 进入页面, **当** 加载完成, **则** 显示最近的闪兑记录，按时间倒序排列<br>2. **假设** 首次加载, **当** 完成, **则** 默认显示"全部"网络的记录<br>3. **假设** 无记录, **当** 列表为空, **则** 显示空状态"暂无闪兑记录" |
| **优先级** | 必须 |

### FR-CW-051-02: 网络筛选

| 字段 | 内容 |
|------|------|
| **ID** | FR-CW-051-02 |
| **描述** | 按区块链网络筛选记录 |
| **验收标准** | 1. **假设** 用户点击网络标签, **当** 选择, **则** 筛选显示对应网络的记录<br>2. **假设** 选择"全部", **当** 筛选, **则** 显示所有网络的记录<br>3. **假设** 筛选后无记录, **当** 显示, **则** 显示"该网络暂无闪兑记录" |
| **优先级** | 应该 |

### FR-CW-051-03: 记录详情展示

| 字段 | 内容 |
|------|------|
| **ID** | FR-CW-051-03 |
| **描述** | 每条记录显示关键信息 |
| **验收标准** | 1. **假设** 显示记录, **当** 渲染, **则** 显示代币对、金额、状态、时间<br>2. **假设** 金额显示, **当** 渲染, **则** 支付金额显示负号，获得金额显示正号（绿色）<br>3. **假设** 状态显示, **当** 渲染, **则** 已完成(绿色)/交易中(黄色)/失败(红色) |
| **优先级** | 必须 |

### FR-CW-051-04: 查看记录详情

| 字段 | 内容 |
|------|------|
| **ID** | FR-CW-051-04 |
| **描述** | 点击记录查看完整详情 |
| **验收标准** | 1. **假设** 用户点击记录, **当** 触发, **则** 弹出详情面板或跳转详情页<br>2. **假设** 详情显示, **当** 渲染, **则** 显示交易哈希、汇率、Gas费、网络等完整信息<br>3. **假设** 详情中交易哈希, **当** 显示, **则** 可点击复制或跳转区块浏览器 |
| **优先级** | 必须 |

### FR-CW-051-05: 下拉刷新

| 字段 | 内容 |
|------|------|
| **ID** | FR-CW-051-05 |
| **描述** | 下拉刷新获取最新记录 |
| **验收标准** | 1. **假设** 用户下拉列表, **当** 触发刷新, **则** 重新加载最新记录<br>2. **假设** 刷新完成, **当** 有新记录, **则** 更新列表并显示新记录 |
| **优先级** | 应该 |

### FR-CW-051-06: 分页加载

| 字段 | 内容 |
|------|------|
| **ID** | FR-CW-051-06 |
| **描述** | 上拉加载更多历史记录 |
| **验收标准** | 1. **假设** 用户滚动到底部, **当** 触发, **则** 加载下一页记录<br>2. **假设** 加载更多, **当** 有更多数据, **则** 追加到列表底部<br>3. **假设** 已加载全部, **当** 无更多数据, **则** 显示"已加载全部" |
| **优先级** | 应该 |

---

## 4. 用户交互

### 4.1 用户工作流

1. 从钱包首页或闪兑页面进入记录页
2. 查看闪兑记录列表
3. （可选）切换网络筛选
4. （可选）下拉刷新获取最新
5. 点击某条记录查看详情
6. 在详情中查看交易哈希或跳转区块浏览器

### 4.2 导航流程

```
钱包首页 → 闪兑记录 (CW-051)
闪兑结果页 → 闪兑记录 (CW-051)
               ↓
         点击记录 → 记录详情弹窗/页面
               ↓
         点击返回 → 上一页
```

### 4.3 手势操作

- 下拉刷新
- 上拉加载更多
- 点击记录查看详情
- 左滑显示更多操作（可选）

---

## 5. 数据需求

### 5.1 显示数据

| 数据项 | 数据类型 | 说明 |
|--------|---------|------|
| 记录ID | String | 记录唯一标识 |
| 源代币 | String | 支付的代币符号 |
| 目标代币 | String | 获得的代币符号 |
| 支付金额 | Decimal | 源代币数量 |
| 获得金额 | Decimal | 目标代币数量 |
| 交易状态 | Enum | completed/pending/failed |
| 交易时间 | DateTime | 交易发起时间 |
| 交易哈希 | String | 区块链交易哈希 |
| 网络 | String | 区块链网络名称 |
| 汇率 | String | 成交汇率 |
| Gas费 | Decimal | 交易 Gas 费用 |

### 5.2 分页参数

| 参数 | 说明 |
|------|------|
| page | 页码，从 1 开始 |
| pageSize | 每页数量，默认 20 |
| network | 筛选网络（可选） |

---

## 6. 验证规则

### 6.1 状态显示规则

| 状态 | 显示文本 | 颜色 |
|------|---------|------|
| completed | 已完成 | 绿色 #00FF00 |
| pending | 交易中 | 黄色 #FFD700 |
| failed | 失败 | 红色 #FF4444 |

### 6.2 金额显示规则

| 类型 | 格式 | 示例 |
|------|------|------|
| 支付金额 | -数量 代币 | -100.0000000 USDT |
| 获得金额 | +数量 代币（绿色） | +0.0500000 ETH |

---

## 7. 技术考虑

### 7.1 性能要求

- 列表加载时间 < 2秒
- 分页加载时间 < 1秒
- 列表项复用优化

### 7.2 API 集成

| 接口 | 说明 |
|------|------|
| 获取闪兑记录列表 | 分页获取用户闪兑记录 |
| 获取记录详情 | 获取单条记录完整信息 |

### 7.3 缓存策略

- 列表数据缓存 5 分钟
- 下拉刷新强制更新缓存
- 详情数据缓存 10 分钟

---

## 8. 验收标准汇总

1. ✅ 正确加载并显示闪兑记录列表
2. ✅ 记录按时间倒序排列
3. ✅ 网络筛选功能正常
4. ✅ 记录状态颜色正确（绿/黄/红）
5. ✅ 金额显示格式正确（+/-符号）
6. ✅ 点击记录可查看详情
7. ✅ 交易哈希可复制
8. ✅ 下拉刷新功能正常
9. ✅ 上拉加载更多正常
10. ✅ 空状态正确显示
11. ✅ UI 符合设计稿

---

## 9. 无障碍访问要求

- [ ] 列表项有完整的无障碍标签
- [ ] 状态信息可被屏幕阅读器朗读
- [ ] 支持键盘导航
- [ ] 下拉刷新有触觉反馈

---

*文档创建日期: 2025-12-09*
