# 移除账户 - 软件需求规格说明书

## 1. 页面标识

| 属性 | 值 |
|------|-----|
| 页面ID | DW-032 |
| 页面名称 | 移除账户 |
| 版本 | 1.0 |
| 更新日期 | 2025-12-08 |
| 状态 | 草稿 |

### 功能描述
移除账户页面是一个确认对话框，用于让用户确认是否要从钱包中移除指定的账户。页面会显示警告信息，告知用户移除后仍可通过助记词恢复，并提供取消和确认移除两个操作选项。

---

## 2. UI组件

### 2.1 布局概述
页面采用全屏确认对话框设计，深色背景主题。顶部有返回按钮，中央显示删除图标和确认信息，底部为双按钮操作区域。整体布局简洁，突出警告信息。

### 2.2 组件详情

| 组件 | 类型 | 描述 | 位置 |
|------|------|------|------|
| 返回按钮 | 图标按钮 | 左箭头图标，返回上一页 | 顶部左侧 |
| 删除图标 | 图标 | 红色圆形背景内的垃圾桶图标 | 中央偏上 |
| 标题文本 | 标签 | "移除账户2"（账户名称动态显示） | 删除图标下方 |
| 说明文本 | 标签 | "即使从wallet中删除了这个钱包，您也可以使用本钱包或其他钱包中的助记符重新获取。" | 标题下方 |
| 取消按钮 | 次要按钮 | 深灰色背景，白色文字"取消" | 底部左侧 |
| 移除按钮 | 危险按钮 | 红色/粉色背景，白色文字"移除" | 底部右侧 |

---

## 3. 功能需求

### FR-032-01: 显示移除确认信息

| 字段 | 内容 |
|------|------|
| **ID** | FR-032-01 |
| **描述** | 系统应显示待移除账户的名称和警告说明信息 |
| **验收标准** | 1. **假设** 用户选择移除某个账户，**当** 确认页面显示，**则** 显示该账户的名称<br>2. **假设** 页面加载完成，**当** 用户查看说明，**则** 显示关于助记词恢复的提示信息 |
| **优先级** | 必须 |

### FR-032-02: 取消移除操作

| 字段 | 内容 |
|------|------|
| **ID** | FR-032-02 |
| **描述** | 用户可以点击取消按钮放弃移除操作 |
| **验收标准** | 1. **假设** 用户在确认页面，**当** 点击"取消"按钮，**则** 返回上一页面，账户保持不变<br>2. **假设** 用户在确认页面，**当** 点击返回按钮，**则** 同样返回上一页面 |
| **优先级** | 必须 |

### FR-032-03: 确认移除账户

| 字段 | 内容 |
|------|------|
| **ID** | FR-032-03 |
| **描述** | 用户点击移除按钮后，系统从钱包中移除该账户 |
| **验收标准** | 1. **假设** 用户在确认页面，**当** 点击"移除"按钮，**则** 系统从本地存储中移除该账户数据<br>2. **假设** 移除成功，**当** 操作完成，**则** 显示成功提示并返回账户列表页面 |
| **优先级** | 必须 |

### FR-032-04: 移除前身份验证

| 字段 | 内容 |
|------|------|
| **ID** | FR-032-04 |
| **描述** | 移除账户前**必须**进行身份验证以确保安全 |
| **验收标准** | 1. **假设** 用户点击移除按钮，**当** 系统处理请求，**则** 弹出FaceID/密码验证<br>2. **假设** 验证失败，**当** 用户重试，**则** 允许再次验证<br>3. **假设** 验证取消，**当** 用户关闭验证界面，**则** 返回确认页面，不执行移除 |
| **优先级** | **必须** |

> **安全说明**：身份验证是移除账户操作的强制要求，不是可选功能。此设计防止未授权的账户删除操作（如他人使用未锁定的设备）。未经验证的账户移除可能被用于隐藏盗窃行为。

---

## 4. 用户交互

### 4.1 用户工作流
1. 用户从账户管理页面选择要移除的账户
2. 系统显示移除确认页面
3. 用户阅读警告信息
4. 用户选择"取消"或"移除"
5. 如选择移除，进行身份验证
6. 验证通过后，系统移除账户
7. 返回账户列表页面

### 4.2 导航流程
- **来源页面**: 管理资料页面、账户详情页面
- **目标页面**:
  - 取消: 返回来源页面
  - 确认移除: 返回账户列表/钱包主页

### 4.3 手势与交互
| 手势 | 行为 |
|------|------|
| 点击返回按钮 | 返回上一页面 |
| 点击取消按钮 | 取消操作，返回上一页面 |
| 点击移除按钮 | 触发身份验证，确认移除 |
| 左滑返回 | 返回上一页面（iOS手势） |

---

## 5. 数据需求

### 5.1 显示数据
| 数据字段 | 类型 | 来源 | 格式 |
|----------|------|------|------|
| 账户名称 | String | 账户数据 | "账户2"等用户自定义名称 |
| 账户地址 | String | 账户数据 | 区块链地址格式 |
| 警告说明 | String | 系统配置 | 本地化文本 |

### 5.2 输入数据
| 输入字段 | 类型 | 验证规则 | 必填 |
|----------|------|----------|------|
| 用户确认 | Button Click | 必须点击移除按钮 | 是 |
| 身份验证 | Biometric/Password | 必须验证通过 | 是 |

---

## 6. 验证规则

### 6.1 操作验证
- 移除操作需要用户明确点击"移除"按钮
- 需要通过身份验证才能执行移除

### 6.2 业务规则
- 不能移除钱包中的最后一个账户
- 移除的账户数据从本地存储中清除
- 账户可以通过助记词重新导入恢复

### 6.3 错误处理
| 错误场景 | 处理方式 |
|----------|----------|
| 身份验证失败 | 显示错误提示，允许重试 |
| 身份验证取消 | 返回确认页面，不执行移除 |
| 是最后一个账户 | 禁止移除，显示提示信息："这是钱包中的最后一个账户，无法移除。如需移除，请先添加其他账户或创建新钱包。" |
| 移除失败 | 显示错误提示，保持账户数据不变 |

---

## 7. 技术考虑

### 7.1 数据清理
- 从本地安全存储中删除账户私钥派生信息
- 清除账户相关的缓存数据（余额、交易记录等）
- 保留助记词主密钥，确保可以重新派生

### 7.2 安全要求
- 执行删除操作前必须验证用户身份
- 使用安全的数据擦除方法
- 记录操作日志用于审计

### 7.3 状态管理
- 更新全局钱包状态，移除账户信息
- 如果移除的是当前活动账户，自动切换到其他账户
- 刷新账户列表UI

### 7.4 恢复机制
- 保留助记词可以重新派生被移除的账户
- 考虑实现软删除，允许短期内恢复

---

## 8. 验收标准汇总

- [ ] 正确显示待移除账户的名称
- [ ] 显示警告说明信息
- [ ] 删除图标使用红色警示颜色
- [ ] 点击返回按钮可返回上一页
- [ ] 点击取消按钮可取消操作
- [ ] 点击移除按钮触发身份验证
- [ ] 身份验证通过后成功移除账户
- [ ] 移除后返回账户列表页面
- [ ] 账户列表中不再显示被移除的账户
- [ ] 不允许移除最后一个账户
- [ ] 移除的账户可通过助记词重新导入
- [ ] **身份验证为必须步骤，不可跳过**
- [ ] **无法移除最后一个账户时显示引导信息**

---

## 9. 无障碍访问要求
- [ ] 所有文本颜色对比度符合WCAG 2.1 AA标准（最低4.5:1）
- [ ] 按钮和可交互元素最小触摸目标为44x44pt
- [ ] 支持屏幕阅读器，所有UI元素有适当的无障碍标签
- [ ] 危险操作按钮有明确的警示颜色和标签
- [ ] 身份验证结果需通过无障碍公告通知用户
- [ ] 支持键盘导航（适用于平板/桌面设备）
