# 添加账户 - 软件需求规格说明书

## 1. 页面标识

| 属性 | 值 |
|------|-----|
| 页面ID | DW-031 |
| 页面名称 | 添加账户 |
| 版本 | 1.0 |
| 更新日期 | 2025-12-08 |
| 状态 | 草稿 |

### 功能描述
添加账户页面允许用户选择并添加新的区块链网络账户到钱包中。页面以底部弹出模态框的形式展示，用户可以浏览不同的Layer 1区块链网络选项，选择需要添加的账户类型。

---

## 2. UI组件

### 2.1 布局概述
页面采用底部弹出模态框设计，深色背景主题。顶部显示标题和关闭按钮，中间区域展示可选的区块链网络卡片，底部为操作按钮区域。

### 2.2 组件详情

| 组件 | 类型 | 描述 | 位置 |
|------|------|------|------|
| 标题文本 | 标签 | 显示"添加账户"标题 | 顶部居中 |
| 关闭按钮 | 图标按钮 | X图标，用于关闭模态框 | 顶部右侧 |
| 说明文本 | 标签 | "选择你需要的区块链网络或特定账户类型，完成相应账户的添加。" | 标题下方 |
| Layer 1标签 | 分组标签 | 显示"Layer 1"分类名称 | 网络卡片上方 |
| OP网络卡片 | 可选卡片 | 显示OP图标、名称和添加按钮 | 中部左侧 |
| XRP网络卡片 | 可选卡片 | 显示XRP图标、名称和添加按钮 | 中部中间 |
| ARB网络卡片 | 可选卡片 | 显示ARB图标、名称和添加按钮 | 中部右侧 |
| 更多选项按钮 | 图标按钮 | 三点菜单图标，每个卡片右上角 | 卡片右上角 |
| 添加图标 | 图标按钮 | 绿色圆形加号图标 | 每个卡片底部 |
| 提示文本 | 标签 | "请先选择账户" | 底部按钮上方 |
| 下一步按钮 | 主按钮 | 绿色圆角按钮，显示"下一步" | 底部 |

---

## 3. 功能需求

### FR-031-01: 显示可用区块链网络

| 字段 | 内容 |
|------|------|
| **ID** | FR-031-01 |
| **描述** | 系统应显示所有可添加的区块链网络列表，按Layer分类展示 |
| **验收标准** | 1. **假设** 用户打开添加账户页面，**当** 页面加载完成，**则** 显示所有支持的区块链网络卡片<br>2. **假设** 网络较多，**当** 用户横向滑动，**则** 可以查看更多网络选项 |
| **优先级** | 必须 |

### FR-031-02: 选择区块链网络

| 字段 | 内容 |
|------|------|
| **ID** | FR-031-02 |
| **描述** | 用户可以点击网络卡片上的添加按钮选择要添加的区块链网络 |
| **验收标准** | 1. **假设** 用户查看网络列表，**当** 点击某个网络卡片的添加按钮，**则** 该网络被选中并显示选中状态<br>2. **假设** 用户已选择一个网络，**当** 再次点击该网络，**则** 取消选择 |
| **优先级** | 必须 |

### FR-031-03: 多网络选择支持

| 字段 | 内容 |
|------|------|
| **ID** | FR-031-03 |
| **描述** | 用户可以同时选择多个区块链网络进行批量添加 |
| **验收标准** | 1. **假设** 用户已选择一个网络，**当** 点击其他网络的添加按钮，**则** 可以同时选中多个网络<br>2. **假设** 用户选择了多个网络，**当** 查看提示文本，**则** 显示已选择的账户数量 |
| **优先级** | 应该 |

### FR-031-04: 确认添加账户

| 字段 | 内容 |
|------|------|
| **ID** | FR-031-04 |
| **描述** | 用户选择网络后点击下一步按钮确认添加 |
| **验收标准** | 1. **假设** 用户未选择任何网络，**当** 查看下一步按钮，**则** 按钮处于禁用状态<br>2. **假设** 用户已选择至少一个网络，**当** 点击下一步按钮，**则** 系统创建对应的账户地址 |
| **优先级** | 必须 |

### FR-031-05: 关闭模态框

| 字段 | 内容 |
|------|------|
| **ID** | FR-031-05 |
| **描述** | 用户可以通过关闭按钮或下滑手势关闭模态框 |
| **验收标准** | 1. **假设** 用户打开添加账户页面，**当** 点击右上角X按钮，**则** 关闭模态框返回上一页<br>2. **假设** 用户打开添加账户页面，**当** 向下滑动模态框，**则** 关闭模态框 |
| **优先级** | 必须 |

---

## 4. 用户交互

### 4.1 用户工作流
1. 用户从设置或钱包管理页面点击"添加账户"
2. 系统弹出添加账户模态框
3. 用户浏览可用的区块链网络列表
4. 用户点击目标网络卡片上的添加按钮进行选择
5. 用户可以继续选择其他网络（可选）
6. 用户点击"下一步"按钮确认添加
7. 系统生成新账户地址并返回钱包页面

### 4.2 导航流程
- **来源页面**: 设置页面、钱包管理页面
- **目标页面**: 账户创建确认页面、钱包主页面

### 4.3 手势与交互
| 手势 | 行为 |
|------|------|
| 点击添加按钮 | 选中/取消选中该网络 |
| 点击X按钮 | 关闭模态框 |
| 向下滑动 | 关闭模态框 |
| 横向滑动 | 查看更多网络选项 |
| 点击更多选项 | 显示网络详细信息 |

---

## 5. 数据需求

### 5.1 显示数据
| 数据字段 | 类型 | 来源 | 格式 |
|----------|------|------|------|
| 网络名称 | String | 系统配置 | 简称如"OP"、"XRP"、"ARB" |
| 网络图标 | Image | 系统资源 | PNG/SVG图标 |
| 网络分类 | String | 系统配置 | "Layer 1"、"Layer 2"等 |
| 选中状态 | Boolean | 用户交互 | true/false |

### 5.2 输入数据
| 输入字段 | 类型 | 验证规则 | 必填 |
|----------|------|----------|------|
| 选中的网络列表 | Array | 至少选择一个网络 | 是 |

---

## 6. 验证规则

### 6.1 选择验证
- 用户必须至少选择一个区块链网络才能继续
- 不允许重复添加已存在的网络账户

### 6.2 错误处理
| 错误场景 | 处理方式 |
|----------|----------|
| 未选择任何网络 | 禁用"下一步"按钮，显示提示"请先选择账户" |
| 网络已存在 | 显示提示"该网络账户已存在" |
| 网络连接失败 | 显示错误提示，允许重试 |

---

## 7. 技术考虑

### 7.1 HD钱包派生
- 使用BIP-44标准派生不同网络的账户地址
- 派生路径格式: m/44'/coin_type'/account'/change/address_index
- 不同网络使用不同的coin_type值

### 7.2 状态管理
- 使用本地状态管理选中的网络列表
- 创建账户后更新全局钱包状态

### 7.3 网络配置
- 从远程配置获取支持的网络列表
- 支持动态更新网络列表

### 7.4 安全考虑
- 新账户地址派生需要访问主私钥
- 需要用户进行身份验证（如FaceID）后才能派生新地址

---

## 8. 验收标准汇总

- [ ] 页面以模态框形式正确弹出
- [ ] 显示所有支持的区块链网络列表
- [ ] 网络按Layer分类展示
- [ ] 可以横向滑动查看更多网络
- [ ] 点击添加按钮可以选中网络
- [ ] 支持多选网络
- [ ] 未选择网络时"下一步"按钮禁用
- [ ] 选择网络后"下一步"按钮可用
- [ ] 点击X按钮可关闭模态框
- [ ] 下滑手势可关闭模态框
- [ ] 成功创建新账户地址
- [ ] 返回钱包页面显示新添加的账户
