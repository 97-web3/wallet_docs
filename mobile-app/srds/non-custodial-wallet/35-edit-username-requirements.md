# 编辑用户名 - 软件需求规格说明书

## 1. 页面标识

| 属性 | 值 |
|------|-----|
| 页面ID | DW-035 |
| 页面名称 | 编辑用户名 |
| 版本 | 1.0 |
| 更新日期 | 2025-12-08 |
| 状态 | 草稿 |

### 功能描述
编辑用户名页面允许用户修改其钱包账户的显示用户名。页面显示当前用户名，提供输入框进行修改，并显示修改频率限制提示（每14天可更改一次）。

---

## 2. UI组件

### 2.1 布局概述
页面采用简洁的表单布局，深色背景主题。顶部显示导航栏，中间是用户名输入框和限制提示，页面激活时自动弹出系统键盘。

### 2.2 组件详情

| 组件 | 类型 | 描述 | 位置 |
|------|------|------|------|
| 返回按钮 | 图标按钮 | 左箭头图标，返回上一页 | 顶部左侧 |
| 页面标题 | 标签 | "编辑用户名" | 顶部居中 |
| 用户名输入框 | 单行文本框 | 深灰色背景，显示当前用户名，带@前缀 | 标题下方 |
| 清除按钮 | 图标按钮 | X图标，用于清空输入框 | 输入框右侧 |
| 限制提示 | 标签 | 信息图标+"每14天可更改一次用户名" | 输入框下方 |
| 系统键盘 | 键盘 | iOS标准QWERTY键盘 | 屏幕底部 |
| 完成按钮 | 键盘按钮 | 蓝色"完成"按钮 | 键盘右下角 |

---

## 3. 功能需求

### FR-035-01: 显示当前用户名

| 字段 | 内容 |
|------|------|
| **ID** | FR-035-01 |
| **描述** | 页面加载时应在输入框中显示用户当前的用户名 |
| **验收标准** | 1. **假设** 用户已设置用户名，**当** 打开编辑页面，**则** 输入框显示当前用户名（如@DapperTowel984）<br>2. **假设** 页面加载完成，**当** 用户查看输入框，**则** 用户名前显示@符号 |
| **优先级** | 必须 |

### FR-035-02: 编辑用户名

| 字段 | 内容 |
|------|------|
| **ID** | FR-035-02 |
| **描述** | 用户可以在输入框中修改用户名 |
| **验收标准** | 1. **假设** 用户在输入框中，**当** 修改文字，**则** 新用户名实时显示<br>2. **假设** 用户点击清除按钮，**当** 按钮被点击，**则** 清空输入框内容 |
| **优先级** | 必须 |

### FR-035-03: 显示修改限制

| 字段 | 内容 |
|------|------|
| **ID** | FR-035-03 |
| **描述** | 页面应显示用户名修改频率限制提示 |
| **验收标准** | 1. **假设** 用户打开编辑页面，**当** 页面显示，**则** 显示"每14天可更改一次用户名"提示<br>2. **假设** 用户在限制期内，**当** 尝试保存，**则** 显示剩余等待天数 |
| **优先级** | 必须 |

### FR-035-04: 保存用户名

| 字段 | 内容 |
|------|------|
| **ID** | FR-035-04 |
| **描述** | 用户点击完成按钮后，系统验证并保存新用户名 |
| **验收标准** | 1. **假设** 用户输入有效用户名，**当** 点击完成按钮，**则** 系统保存新用户名并返回上一页<br>2. **假设** 用户名已被占用，**当** 尝试保存，**则** 显示错误提示"用户名已被占用" |
| **优先级** | 必须 |

### FR-035-05: 用户名唯一性检查

| 字段 | 内容 |
|------|------|
| **ID** | FR-035-05 |
| **描述** | 系统应检查新用户名是否已被其他用户使用 |
| **验收标准** | 1. **假设** 用户输入新用户名，**当** 系统检查，**则** 验证用户名是否已存在<br>2. **假设** 用户名可用，**当** 验证通过，**则** 允许保存 |
| **优先级** | 应该 |

---

## 4. 用户交互

### 4.1 用户工作流
1. 用户从管理资料页面进入编辑用户名
2. 页面显示当前用户名和修改限制提示
3. 键盘自动弹出，光标定位到输入框末尾
4. 用户修改用户名
5. 用户点击键盘上的"完成"按钮
6. 系统验证用户名有效性和唯一性
7. 验证通过后保存并返回

### 4.2 导航流程
- **来源页面**: 管理资料页面
- **目标页面**:
  - 保存成功: 返回管理资料页面
  - 取消: 返回管理资料页面

### 4.3 手势与交互
| 手势 | 行为 |
|------|------|
| 点击返回按钮 | 取消编辑，返回上一页 |
| 点击输入框 | 激活输入，弹出键盘 |
| 点击清除按钮 | 清空输入框内容 |
| 点击键盘完成 | 验证并保存用户名 |

---

## 5. 数据需求

### 5.1 显示数据
| 数据字段 | 类型 | 来源 | 格式 |
|----------|------|------|------|
| 当前用户名 | String | 用户数据 | @username格式 |
| 上次修改时间 | Date | 用户数据 | ISO日期格式 |
| 剩余等待天数 | Number | 计算得出 | 整数天数 |

### 5.2 输入数据
| 输入字段 | 类型 | 验证规则 | 必填 |
|----------|------|----------|------|
| 新用户名 | String | 3-20字符，仅字母数字下划线 | 是 |

---

## 6. 验证规则

### 6.1 输入验证
- 用户名长度：3-20个字符
- 允许字符：字母（a-z, A-Z）、数字（0-9）、下划线（_）
- 不允许特殊字符和空格
- 不允许纯数字用户名
- 不允许敏感词汇

### 6.2 业务规则
- 用户名每14天只能修改一次
- 用户名必须全局唯一
- 用户名不区分大小写进行唯一性检查

### 6.3 错误处理
| 错误场景 | 处理方式 |
|----------|----------|
| 用户名过短 | 显示"用户名至少3个字符" |
| 用户名过长 | 限制输入，显示字符计数 |
| 包含非法字符 | 显示"用户名只能包含字母、数字和下划线" |
| 用户名已被占用 | 显示"该用户名已被使用" |
| 修改频率限制 | 显示"距离下次可修改还有X天" |

---

## 7. 技术考虑

### 7.1 用户名存储
- 本地存储当前用户名和上次修改时间
- 如支持链上身份，同步到区块链或后端服务

### 7.2 唯一性检查
- 调用后端API验证用户名唯一性
- 输入时实时检查（防抖处理）

### 7.3 修改频率限制
- 本地计算距上次修改的天数
- 结合服务端时间防止本地时间篡改

### 7.4 大小写处理
- 显示时保留用户输入的大小写
- 唯一性检查时转换为小写比较

---

## 8. 验收标准汇总

- [ ] 页面标题正确显示"编辑用户名"
- [ ] 返回按钮正常工作
- [ ] 输入框显示当前用户名（带@前缀）
- [ ] 清除按钮可以清空输入内容
- [ ] 显示"每14天可更改一次用户名"提示
- [ ] 进入页面自动弹出键盘
- [ ] 可以正常编辑用户名
- [ ] 用户名格式验证正常工作
- [ ] 用户名唯一性检查正常工作
- [ ] 修改频率限制正常执行
- [ ] 限制期内显示剩余等待天数
- [ ] 保存成功后返回并更新显示
- [ ] 错误情况显示友好提示
