# 货币设置 - 软件需求规格说明书

## 1. 页面标识
- **页面名称**: 货币设置页
- **页面ID**: CURRENCY_SETTINGS_001
- **页面描述/用途**: 允许用户选择应用中显示的法定货币单位

## 2. UI组件
### 2.1 布局概述
页面采用列表布局,顶部为搜索框,下方为货币选项列表。每个货币项显示为单选列表项,选中项用绿色圆点标识。采用暗黑主题。

### 2.2 组件详情
| 组件名称 | 组件类型 | 位置 | 描述 |
|---------|---------|------|------|
| 状态栏 | 系统组件 | 顶部 | 显示时间(9:41)、信号、WiFi和电池状态 |
| 返回按钮 | 图标按钮 | 左上角 | 左箭头,返回上一页 |
| 页面标题 | 标题文本 | 顶部中心 | "货币" |
| 搜索框 | 输入框 | 标题下方 | 带搜索图标,"搜索..."占位符 |
| 货币列表 | 滚动列表 | 主体区域 | 显示所有支持的货币选项 |
| USD货币项 | 列表项 | 列表顶部 | "USD- United States Dollar ($)",选中状态 |
| 选中指示器 | 单选按钮 | USD项右侧 | 绿色圆点,表示当前选中 |
| EUR货币项 | 列表项 | 列表中 | "EUR-Euro(E)",未选中状态 |
| DZD货币项 | 列表项 | 列表中 | "DZD-Algerian Dinar (z.)" |
| ARS货币项 | 列表项 | 列表中 | "ARS- Argentine Peso (AR$)" |
| AUD货币项 | 列表项 | 列表中 | "AUD- Australian Dollar(A$)" |
| BRL货币项 | 列表项 | 列表中 | "BRL- Brazilian Real (R$)" |
| GBP货币项 | 列表项 | 列表中 | "GBP- British Pound (E)" |
| BGN货币项 | 列表项 | 列表中 | "BGN- Bulgarian Lev (nB)" |
| CAD货币项 | 列表项 | 列表中 | "CAD- Canadian Dollar (CA$)" |
| 未选中指示器 | 单选按钮 | 未选中项右侧 | 灰色空圆圈 |

## 3. 功能需求
### 3.1 主要功能
- 显示所有支持的法定货币列表
- 支持搜索货币(按代码或名称)
- 单选货币(同一时间只能选择一个)
- 显示当前选中的货币
- 保存用户选择
- 应用选择后全局生效(所有代币价格、金额都使用选定货币显示)

### 3.2 业务逻辑
- 默认货币:首次使用时根据地区自动选择
- 单选模式:选择新货币自动取消之前的选择
- 即时生效:选择后立即保存并应用
- 全局影响:影响所有价格显示、资产计价等
- 持久化:选择保存到本地存储

## 4. 用户交互
### 4.1 用户操作
| 操作 | 触发条件 | 响应 |
|-----|---------|------|
| 点击返回按钮 | 单击 | 返回设置页面或我的页面 |
| 输入搜索关键字 | 文字输入 | 实时过滤货币列表 |
| 点击货币项 | 单击 | 选中该货币,取消之前选择,自动返回 |
| 上下滑动 | 滑动手势 | 浏览完整货币列表 |
| 清除搜索 | 点击清除按钮 | 显示完整货币列表 |

### 4.2 导航流程
- 设置页面 → 此页面(货币设置)
- 货币设置页 → 选择货币 → 自动返回设置页面
- 货币设置页 → 返回按钮 → 设置页面

### 4.3 手势操作
- 单击:选择货币
- 滑动:浏览列表
- 键盘输入:搜索货币

## 5. 数据需求
### 5.1 数据展示
| 数据字段 | 数据类型 | 描述 |
|---------|---------|------|
| 货币代码 | String | ISO 4217货币代码(USD、EUR等) |
| 货币全称 | String | 货币的完整名称 |
| 货币符号 | String | 货币符号($、€、¥等) |
| 当前选中 | Boolean | 是否为当前选中的货币 |
| 显示名称 | String | 列表中显示的格式化名称 |

### 5.2 数据输入
- 搜索关键字:用户输入的搜索文本
- 选择的货币:用户点击的货币选项

### 5.3 数据来源
- 本地配置:支持的货币列表
- 用户设置:当前选中的货币
- 地区设置:自动检测用户地区的默认货币

## 6. 验证规则
### 6.1 输入验证
- 搜索关键字:任意文本
- 货币选择:必须是支持列表中的货币

### 6.2 错误处理
- 搜索无结果:显示"未找到匹配的货币"
- 保存失败:显示"设置保存失败,请重试"
- 恢复默认:出错时恢复到默认货币

## 7. 技术考量
### 7.1 状态管理
- 货币列表状态
- 当前选中货币状态
- 搜索关键字状态
- 过滤后列表状态
- 保存状态

### 7.2 API集成
- 价格API:需支持多货币查询
  - 代币价格需要转换为选定货币
- 汇率API(可选):
  - 实时汇率更新
  - CoinGecko、CoinMarketCap都支持多货币

### 7.3 安全考量
- 输入清理:防止搜索注入
- 设置验证:确保选择的货币有效
- 本地存储安全:加密存储用户设置

## 8. 货币列表
### 8.1 主要货币
- USD - United States Dollar ($)
- EUR - Euro (€)
- GBP - British Pound (£)
- JPY - Japanese Yen (¥)
- CNY - Chinese Yuan (¥)
- KRW - Korean Won (₩)
- AUD - Australian Dollar (A$)
- CAD - Canadian Dollar (CA$)

### 8.2 货币排序
- 默认排序:按货币代码字母顺序
- 可选排序:常用货币优先
- 搜索结果:按匹配度排序

### 8.3 货币数据格式
```json
{
  "code": "USD",
  "name": "United States Dollar",
  "symbol": "$",
  "locale": "en-US"
}
```

## 9. 搜索功能
### 9.1 搜索范围
- 货币代码(USD、EUR等)
- 货币全称(United States Dollar等)
- 货币符号($、€等)

### 9.2 搜索特性
- 实时搜索:输入即过滤
- 大小写不敏感
- 部分匹配
- 高亮匹配文本(可选)

### 9.3 搜索优化
- 防抖处理:300ms延迟
- 缓存结果:避免重复计算
- 智能排序:完全匹配优先

## 10. 应用影响
### 10.1 影响范围
- 首页资产总价值
- 代币详情价格
- 交易金额等值显示
- 历史交易法币价值
- 图表价格标注
- 所有涉及法币显示的地方

### 10.2 生效时机
- 立即生效:选择后立即更新所有显示
- 需要刷新:某些页面可能需要刷新数据
- 缓存清理:清除旧货币的缓存数据

## 11. 性能要求
### 11.1 响应时间
- 页面加载:< 500毫秒
- 搜索响应:< 200毫秒
- 货币切换:< 300毫秒
- 设置保存:< 100毫秒

### 11.2 优化策略
- 列表虚拟化(货币数量>100时)
- 搜索防抖
- 本地缓存货币列表
- 异步保存设置

## 12. 验收标准
- [ ] 正确显示所有支持的货币
- [ ] 当前选中货币有绿色标识
- [ ] 未选中货币显示灰色圆圈
- [ ] 搜索功能正常工作
- [ ] 搜索结果准确
- [ ] 点击货币能正确切换
- [ ] 切换后自动返回上一页
- [ ] 货币选择立即保存
- [ ] 返回主页后价格使用新货币显示
- [ ] 空搜索结果有提示
- [ ] 返回按钮功能正常
- [ ] 列表滚动流畅
- [ ] 搜索响应快速
- [ ] 在不同屏幕尺寸下正常显示
- [ ] 暗黑主题样式正确
- [ ] 货币符号显示正确
- [ ] 首次使用默认货币合理
