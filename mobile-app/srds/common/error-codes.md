# 错误码规格 - 通用规格文档

## 文档标识

| 属性 | 值 |
|------|-----|
| 文档ID | COMMON-008 |
| 文档名称 | 错误码规格 |
| 版本 | 1.0 |
| 创建日期 | 2025-12-09 |
| 状态 | 草稿 |

### 概述

本文档定义了钱包应用中所有错误码的命名规范、分类和处理建议。

> 相关规格: [COMMON-006 术语表](./glossary.md)

---

## 1. 错误码格式

### 1.1 命名规范

```
[模块]-[序号]

模块: 3-4个大写字母，标识错误来源
序号: 3位数字，模块内唯一
```

### 1.2 模块代码

| 模块代码 | 模块名称 | 说明 |
|---------|---------|------|
| AUTH | 认证模块 | 登录、注册、身份验证 |
| WAL | 钱包模块 | 钱包创建、导入、管理 |
| TX | 交易模块 | 充值、提现、转账 |
| SWAP | 闪兑模块 | 代币兑换 |
| SEC | 安全模块 | 密码、GA、生物识别 |
| NET | 网络模块 | 网络连接、API调用 |
| VAL | 验证模块 | 输入验证、格式校验 |
| SYS | 系统模块 | 系统级错误 |

---

## 2. 认证类错误码 (AUTH)

| 错误码 | 消息 | 说明 | 处理建议 |
|--------|------|------|---------|
| AUTH-001 | 账户不存在 | 登录时账户未找到 | 提示注册或检查账户 |
| AUTH-002 | 密码错误 | 登录密码不正确 | 提示重新输入，显示剩余尝试次数 |
| AUTH-003 | 账户已锁定 | 多次密码错误后锁定 | 提示等待时间或联系客服 |
| AUTH-004 | 验证码错误 | 短信/邮箱验证码不正确 | 提示重新输入或重新发送 |
| AUTH-005 | 验证码已过期 | 验证码超时失效 | 提示重新发送验证码 |
| AUTH-006 | 账户已注册 | 注册时账户已存在 | 提示登录或找回密码 |
| AUTH-007 | Token已过期 | 登录Token失效 | 自动跳转登录页 |
| AUTH-008 | Token无效 | Token格式错误或被篡改 | 自动跳转登录页 |
| AUTH-009 | 设备未授权 | 新设备需要验证 | 引导进行设备验证 |
| AUTH-010 | 账户已注销 | 账户已被注销 | 提示联系客服 |

---

## 3. 钱包类错误码 (WAL)

| 错误码 | 消息 | 说明 | 处理建议 |
|--------|------|------|---------|
| WAL-001 | 助记词无效 | 助记词不符合BIP39标准 | 高亮无效单词，提示检查 |
| WAL-002 | 助记词数量错误 | 助记词不是12个 | 提示"助记词必须为12个单词" |
| WAL-003 | 私钥格式错误 | 私钥格式不正确 | 提示检查私钥格式 |
| WAL-004 | 钱包已存在 | 导入的钱包地址已存在 | 提示"该钱包已导入" |
| WAL-005 | 钱包名称重复 | 钱包名称与已有重复 | 提示修改钱包名称 |
| WAL-006 | 钱包不存在 | 操作的钱包未找到 | 刷新钱包列表 |
| WAL-007 | 助记词验证失败 | 验证助记词时输入错误 | 标记错误输入框，允许重试 |
| WAL-008 | 钱包创建失败 | 系统错误导致创建失败 | 提示重试或联系客服 |
| WAL-009 | 钱包导出失败 | 导出私钥/助记词失败 | 验证身份后重试 |

---

## 4. 交易类错误码 (TX)

| 错误码 | 消息 | 说明 | 处理建议 |
|--------|------|------|---------|
| TX-001 | 余额不足 | 可用余额小于交易金额 | 显示当前余额，提示充值 |
| TX-002 | 金额低于最小值 | 交易金额低于10 USDT等值 | 提示"最小金额为10 USDT等值" |
| TX-003 | 地址格式错误 | 收款地址格式不正确 | 提示检查地址格式 |
| TX-004 | 地址与网络不匹配 | 地址与选择的网络不兼容 | 提示选择正确的网络 |
| TX-005 | 交易提交失败 | 链上交易提交失败 | 显示失败原因，允许重试 |
| TX-006 | 交易超时 | 交易长时间未确认 | 提示查看交易状态 |
| TX-007 | Gas费用不足 | Gas余额不足以支付手续费 | 提示充值Gas代币 |
| TX-008 | Nonce冲突 | 交易Nonce重复 | 自动调整Nonce重试 |
| TX-009 | 收款方不存在 | 内部划转收款方未找到 | 提示检查UID/邮箱/手机号 |
| TX-010 | 不能转给自己 | 收款地址与发送地址相同 | 提示"不能向自己转账" |
| TX-011 | 审核中 | 交易正在审核中 | 显示预计审核时间 |
| TX-012 | 审核驳回 | 交易审核未通过 | 显示驳回原因 |
| TX-013 | 提现冻结 | 账户提现功能被冻结 | 提示联系客服解冻 |
| TX-014 | 超出日限额 | 超过单日交易限额 | 显示剩余限额 |
| TX-015 | 超出月限额 | 超过单月交易限额 | 显示剩余限额 |

---

## 5. 闪兑类错误码 (SWAP)

| 错误码 | 消息 | 说明 | 处理建议 |
|--------|------|------|---------|
| SWAP-001 | 报价已过期 | 获取的报价已超时 | 自动刷新报价 |
| SWAP-002 | 滑点超出限制 | 实际滑点超过设置值 | 提示调整滑点或金额 |
| SWAP-003 | 流动性不足 | 交易对流动性不足 | 提示减少交易金额 |
| SWAP-004 | 代币对不支持 | 该代币对不支持兑换 | 显示支持的代币列表 |
| SWAP-005 | 获取报价失败 | 无法获取交易报价 | 提示稍后重试 |
| SWAP-006 | 交易执行失败 | DEX交易执行失败 | 显示失败原因 |
| SWAP-007 | 授权失败 | 代币授权失败 | 提示重新授权 |
| SWAP-008 | 金额超出限制 | 单笔兑换超出限额 | 显示限额范围 |

---

## 6. 安全类错误码 (SEC)

| 错误码 | 消息 | 说明 | 处理建议 |
|--------|------|------|---------|
| SEC-001 | 资金密码错误 | 资金密码不正确 | 显示剩余尝试次数 |
| SEC-002 | 资金密码已锁定 | 多次错误后锁定 | 提示解锁方式 |
| SEC-003 | GA验证码错误 | Google Authenticator码错误 | 提示检查时间同步 |
| SEC-004 | GA未绑定 | 需要GA但未绑定 | 引导绑定GA |
| SEC-005 | 生物识别失败 | FaceID/TouchID验证失败 | 提示使用备用验证方式 |
| SEC-006 | 生物识别不可用 | 设备不支持或未启用 | 使用其他验证方式 |
| SEC-007 | 安全等级不足 | 操作需要更高安全等级 | 提示完成安全设置 |
| SEC-008 | 验证次数超限 | 验证失败次数过多 | 提示等待冷却时间 |
| SEC-009 | 旧密码错误 | 修改密码时旧密码不正确 | 提示重新输入 |
| SEC-010 | 密码格式错误 | 新密码不符合格式要求 | 显示密码要求 |

---

## 7. 网络类错误码 (NET)

| 错误码 | 消息 | 说明 | 处理建议 |
|--------|------|------|---------|
| NET-001 | 网络连接失败 | 无法连接到服务器 | 检查网络后重试 |
| NET-002 | 请求超时 | API请求超时 | 自动重试或手动重试 |
| NET-003 | 服务器错误 | 服务器内部错误 | 稍后重试 |
| NET-004 | 服务不可用 | 服务暂时不可用 | 显示维护提示 |
| NET-005 | 请求频率超限 | API调用频率过高 | 提示稍后重试 |
| NET-006 | RPC节点错误 | 区块链RPC节点异常 | 自动切换节点 |
| NET-007 | 链上数据同步中 | 区块数据同步延迟 | 提示稍后查看 |

---

## 8. 验证类错误码 (VAL)

| 错误码 | 消息 | 说明 | 处理建议 |
|--------|------|------|---------|
| VAL-001 | 必填字段为空 | 必填项未填写 | 高亮必填字段 |
| VAL-002 | 格式不正确 | 输入格式不符合要求 | 显示正确格式示例 |
| VAL-003 | 数值超出范围 | 输入值超出允许范围 | 显示允许范围 |
| VAL-004 | 字符长度超限 | 输入字符超过长度限制 | 显示长度限制 |
| VAL-005 | 包含非法字符 | 输入包含不允许的字符 | 显示允许的字符类型 |
| VAL-006 | UID格式错误 | UID格式不正确 | 提示正确的UID格式 |
| VAL-007 | 邮箱格式错误 | 邮箱格式不正确 | 提示正确的邮箱格式 |
| VAL-008 | 手机号格式错误 | 手机号格式不正确 | 提示正确的手机号格式 |

---

## 9. 系统类错误码 (SYS)

| 错误码 | 消息 | 说明 | 处理建议 |
|--------|------|------|---------|
| SYS-001 | 系统繁忙 | 系统负载过高 | 稍后重试 |
| SYS-002 | 功能维护中 | 功能正在维护 | 显示预计恢复时间 |
| SYS-003 | 版本过低 | APP版本过低 | 引导更新APP |
| SYS-004 | 数据加载失败 | 本地数据加载失败 | 清除缓存重试 |
| SYS-005 | 未知错误 | 未预期的错误 | 记录日志，提示联系客服 |

---

## 10. 错误展示规范

### 10.1 展示方式

| 错误类型 | 展示方式 | 示例 |
|---------|---------|------|
| 字段验证错误 | 输入框下方红色文字 | 红色边框 + 错误提示 |
| 业务错误 | Toast提示 | 底部弹出，2秒后消失 |
| 严重错误 | 弹窗提示 | 需用户确认后关闭 |
| 网络错误 | 页面提示 + 重试按钮 | 空状态页面 |

### 10.2 错误日志

所有错误应记录以下信息：
- 错误码
- 错误消息
- 发生时间
- 用户ID（如已登录）
- 设备信息
- 页面路径
- 请求参数（脱敏）

---

## 11. 国际化支持

错误消息支持多语言，格式：

```json
{
  "error_code": "TX-001",
  "messages": {
    "zh-CN": "余额不足",
    "en-US": "Insufficient balance",
    "zh-TW": "餘額不足"
  }
}
```

---

## 12. 验收标准

1. [ ] 所有错误码按规范命名
2. [ ] 错误消息简洁明确
3. [ ] 提供用户可操作的处理建议
4. [ ] 严重错误有日志记录
5. [ ] 支持多语言错误消息
6. [ ] 错误展示方式符合规范
7. [ ] 敏感信息在错误中脱敏处理
8. [ ] 网络错误有重试机制

---

*文档创建日期: 2025-12-09*
